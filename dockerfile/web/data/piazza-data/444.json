{"result": {"history_size": 2, "folders": ["lab1"], "nr": 444, "data": {"embed_links": []}, "created": "2015-05-19T01:48:13Z", "bucket_order": 3, "no_answer_followup": 0, "change_log": [{"uid": "i9umei6gOH2", "anon": "no", "when": "2015-05-19T01:48:13Z", "data": "i9unvrfp1635n5", "type": "create"}, {"uid": "i9umei6gOH2", "anon": "no", "when": "2015-05-19T01:49:39Z", "data": "i9unxmg2qe312i", "type": "update"}, {"to": "i9unvrfn2ne5n4", "uid": "hdjoucuyb836fq", "anon": "no", "when": "2015-05-19T02:45:22Z", "data": "i9upx9owkmt5sx", "type": "i_answer"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "i9umei6gOH2", "subject": "关于lab1  bootmain  ELFHDR的一些疑问 以及readseg函数的一个问题", "created": "2015-05-19T01:49:39Z", "content": "<p>在bootmain.c里面可以看到</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\"><span style=\"font-weight:bold;color:#008000\">#define</span><span style=\"color:#808080\"> </span>ELFHDR<span style=\"color:#808080\">          </span><span style=\"font-weight:bold\">((</span><span style=\"font-weight:bold;color:#000080\">struct</span><span style=\"color:#808080\"> </span>elfhdr<span style=\"color:#808080\"> </span><span style=\"font-weight:bold\">*)</span><span style=\"color:#008080\">0x10000</span><span style=\"font-weight:bold\">)</span></p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">这里用的是结构体指针强转的方式定义了一个<strong>0x10000</strong>的地址作为elf文件在内存中的入口地址</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">而观察tools/kernel.ld文件&#xff0c;开头有这么几句话&#xff1a;</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">ENTRY(kern_init)<br /><br />SECTIONS {<br />    /* Load the kernel at this address: &#34;.&#34; means the current address */<br />    . = <strong>0x100000</strong>;</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">这里的意思不是说默认了kern_init从内存的<strong>0x100000</strong>开始嘛&#xff1f;与bootmain复制的0x10000不一致</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">请问我这里理解哪里有问题</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">我观察了试验一的答案程序&#xff0c;仍然是复制到<strong>0x10000</strong>这个地址去&#xff0c;如果改成<strong>0x100000</strong>反而会出现死机报错的现象&#xff0c;因为初次接触makefile或许还有我没注意的地方&#xff0c;麻烦高手解答一下为什么复制到<strong>0x10000</strong>地址</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\"></p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">此外还有一个问题&#xff1a;</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">readseg函数中有这么一句&#xff1a;</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\"><span style=\"color:#808080\"></span>va<span style=\"color:#808080\"> </span><span style=\"font-weight:bold\">-=</span><span style=\"color:#808080\"> </span>offset<span style=\"color:#808080\"> </span><span style=\"font-weight:bold\">%</span><span style=\"color:#808080\"> </span>SECTSIZE<span style=\"font-weight:bold\">;</span></p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">这句程序为什么要用减法来对齐sector地址&#xff0c;这样的话如果offset不是整512字节调用的话就会执行减法&#xff0c;除非指定的va能相对配合&#xff0c;且需要的字节不在硬盘sector头部&#xff0c;虽然整段程序实际上保证了没用到这个计算&#xff0c;读取的都是整段的sector&#xff0c;那么这句话很奇怪的写在这里&#xff0c;还占用了引导扇区的宝贵字节&#xff0c;到底是为了什么呢&#xff1f;</p>"}, {"anon": "no", "uid": "i9umei6gOH2", "subject": "关于lab1  bootmain  ELFHDR的一些疑问 以及readseg函数的一个问题", "created": "2015-05-19T01:48:13Z", "content": "<p>在bootmain.c里面可以看到</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\"><span style=\"font-weight:bold;color:#008000\">#define</span><span style=\"color:#808080\"> </span>ELFHDR<span style=\"color:#808080\">          </span><span style=\"font-weight:bold\">((</span><span style=\"font-weight:bold;color:#000080\">struct</span><span style=\"color:#808080\"> </span>elfhdr<span style=\"color:#808080\"> </span><span style=\"font-weight:bold\">*)</span><span style=\"color:#008080\">0x10000</span><span style=\"font-weight:bold\">)</span></p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">这里用的是结构体指针强转的方式定义了一个<strong>0x10000</strong>的地址作为elf文件在内存中的入口地址</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">而观察tools/kernel.ld文件&#xff0c;开头有这么几句话&#xff1a;</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">ENTRY(kern_init)<br /><br />SECTIONS {<br />    /* Load the kernel at this address: &#34;.&#34; means the current address */<br />    . = <strong>0x100000</strong>;</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">这里的意思不是说默认了kern_init从内存的<strong>0x10000</strong>开始嘛&#xff1f;与bootmain复制的0x10000不一致</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">请问我这里理解哪里有问题</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">我观察了试验一的答案程序&#xff0c;仍然是复制到<strong>0x10000</strong>这个地址去&#xff0c;如果改成<strong>0x100000</strong>反而会出现死机报错的现象&#xff0c;因为初次接触makefile或许还有我没注意的地方&#xff0c;麻烦高手解答一下为什么复制到<strong>0x10000</strong>地址</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\"></p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">此外还有一个问题&#xff1a;</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">readseg函数中有这么一句&#xff1a;</p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\"><span style=\"color:#808080\"></span>va<span style=\"color:#808080\"> </span><span style=\"font-weight:bold\">-=</span><span style=\"color:#808080\"> </span>offset<span style=\"color:#808080\"> </span><span style=\"font-weight:bold\">%</span><span style=\"color:#808080\"> </span>SECTSIZE<span style=\"font-weight:bold\">;</span></p>\n<p style=\"font-family:&#34;courier&#34;;font-size:10pt\">这句程序为什么要用减法来对齐sector地址&#xff0c;这样的话如果offset不是整512字节调用的话就会执行减法&#xff0c;除非指定的va能相对配合&#xff0c;且需要的字节不在硬盘sector头部&#xff0c;虽然整段程序实际上保证了没用到这个计算&#xff0c;读取的都是整段的sector&#xff0c;那么这句话很奇怪的写在这里&#xff0c;还占用了引导扇区的宝贵字节&#xff0c;到底是为了什么呢&#xff1f;</p>"}], "type": "question", "tags": ["lab1", "student"], "tag_good": [], "unique_views": 155, "children": [{"history_size": 1, "folders": [], "data": {"embed_links": []}, "created": "2015-05-19T02:45:22Z", "bucket_order": 3, "tag_endorse": [{"role": "", "name": "Jialiang Cao", "endorser": {}, "admin": false, "photo": null, "id": "jh1ahmqehdv28y", "photo_url": null, "us": false, "facebook_id": null}, {"role": "student", "name": "YM DING", "endorser": {}, "admin": false, "photo": null, "id": "kb04thoskk99i", "photo_url": null, "published": true, "us": false, "facebook_id": null}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "hdjoucuyb836fq", "subject": "", "created": "2015-05-19T02:45:22Z", "content": "<p>1. ELFHDR定义的那一行后面有个注释</p>\n<p></p>\n<pre>#define ELFHDR          ((struct elfhdr *)0x10000)      // scratch space</pre>\n<p>这个地址实际上是bootloader用来缓存文件头的&#xff0c;和kernel的起始地址没有关系。</p>\n<p></p>\n<p>2. 磁盘只能以512字节为单位进行访问&#xff0c;不能进行任意字节的访问。</p>"}], "type": "i_answer", "tag_endorse_arr": ["jh1ahmqehdv28y", "kb04thoskk99i"], "children": [], "id": "i9upx9oss595sw", "config": {}, "is_tag_endorse": false}], "tag_good_arr": [], "no_answer": 0, "id": "i9unvrfn2ne5n4", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 5, "num_favorites": 1, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643167807718, "default_anonymity": "no"}, "error": null, "aid": "kyuzoqueaxs26j"}