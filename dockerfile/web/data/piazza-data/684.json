{"result": {"history_size": 1, "folders": ["lab2", "lab3", "lab4", "lab5", "lab6", "lab7", "lab8"], "nr": 684, "data": {"embed_links": []}, "created": "2016-03-13T13:17:09Z", "bucket_order": 3, "no_answer_followup": 0, "change_log": [{"uid": "i0c1nsm3911wc", "anon": "no", "when": "2016-03-13T13:17:09Z", "data": "ilql5g0amu95lu", "type": "create"}, {"to": "ilql5g08ser5lt", "uid": "i0f24oie8102cr", "anon": "no", "when": "2016-03-13T13:26:07Z", "type": "followup"}, {"to": "ilql5g08ser5lt", "uid": "i0zaci5voig5h", "anon": "no", "when": "2016-03-14T00:35:08Z", "type": "followup"}, {"to": "ilql5g08ser5lt", "uid": "i6w84pnmjCQ", "anon": "no", "when": "2016-03-14T00:46:25Z", "type": "feedback"}, {"to": "ilql5g08ser5lt", "uid": "i0c1nsm3911wc", "anon": "no", "when": "2016-03-15T03:32:20Z", "type": "feedback"}, {"to": "ilql5g08ser5lt", "uid": "ikvcvmzbvlf7i6", "anon": "no", "when": "2016-03-21T03:17:27Z", "type": "followup"}, {"to": "ilql5g08ser5lt", "uid": "i242q8ug7vw40x", "anon": "no", "when": "2016-03-22T04:04:35Z", "type": "followup"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "i0c1nsm3911wc", "subject": "总结一下已经遇到的ucore lab的坑", "created": "2016-03-13T13:17:09Z", "content": "<p></p><ul><li>For mac os X</li></ul>\n<p>注意&#xff1a;此部分只会在mac下出现问题&#xff0c;对于特定的Linux发行版&#xff08;如Ubuntu 15.10&#xff09;就不会出现问题。</p>\n<p></p>\n<p>1. Makefile</p>\n<p>从Lab2开始&#xff0c;所有Makefile开头的部分</p>\n<pre>ifndef GCCPREFIX\nGCCPREFIX := $(shell if i386-ucore-elf-objdump -i 2&gt;&amp;1 | grep &#39;^elf32-i386$$&#39; &gt;/dev/null 2&gt;&amp;1; \\\n\tthen echo &#39;i386-ucore-elf-&#39;; \\\n\telif objdump -i 2&gt;&amp;1 | grep &#39;elf32-i386&#39; &gt;/dev/null 2&gt;&amp;1; \\\n\tthen echo &#39;&#39;; \\\n\telse echo &#34;***&#34; 1&gt;&amp;2; \\\n\techo &#34;*** Error: Couldn&#39;t find an i386-ucore-elf version of GCC/binutils.&#34; 1&gt;&amp;2; \\\n\techo &#34;*** Is the directory with i386-ucore-elf-gcc in your PATH?&#34; 1&gt;&amp;2; \\\n\techo &#34;*** If your i386-ucore-elf toolchain is installed with a command&#34; 1&gt;&amp;2; \\\n\techo &#34;*** prefix other than &#39;i386-ucore-elf-&#39;, set your GCCPREFIX&#34; 1&gt;&amp;2; \\\n\techo &#34;*** environment variable to that prefix and run &#39;make&#39; again.&#34; 1&gt;&amp;2; \\\n\techo &#34;*** To turn off this error, run &#39;gmake GCCPREFIX= ...&#39;.&#34; 1&gt;&amp;2; \\\n\techo &#34;***&#34; 1&gt;&amp;2; exit 1; fi)\nendif\n中都出现了神奇的\n\n</pre><pre>i386-ucore</pre>\n把它们改成\n\n<pre>i386</pre>\n就可以work了&#xff0c;即改成&#xff1a;\n\n<pre>ifndef GCCPREFIX\nGCCPREFIX := $(shell if i386-elf-objdump -i 2&gt;&amp;1 | grep &#39;^elf32-i386</pre>$$&#39; &gt;/dev/null 2&gt;&amp;1; \\<br />\tthen echo &#39;i386-elf-&#39;; \\\n\telif objdump -i 2&gt;&amp;1 | grep &#39;elf32-i386&#39; &gt;/dev/null 2&gt;&amp;1; \\\n\tthen echo &#39;&#39;; \\\n\telse echo &#34;***&#34; 1&gt;&amp;2; \\\n\techo &#34;*** Error: Couldn&#39;t find an i386-elf version of GCC/binutils.&#34; 1&gt;&amp;2; \\\n\techo &#34;*** Is the directory with i386-elf-gcc in your PATH?&#34; 1&gt;&amp;2; \\\n\techo &#34;*** If your i386-elf toolchain is installed with a command&#34; 1&gt;&amp;2; \\\n\techo &#34;*** prefix other than &#39;i386-elf-&#39;, set your GCCPREFIX&#34; 1&gt;&amp;2; \\\n\techo &#34;*** environment variable to that prefix and run &#39;make&#39; again.&#34; 1&gt;&amp;2; \\\n\techo &#34;*** To turn off this error, run &#39;gmake GCCPREFIX= ...&#39;.&#34; 1&gt;&amp;2; \\\n\techo &#34;***&#34; 1&gt;&amp;2; exit 1; fi)\nendif\n<p>否则&#xff0c;报错&#xff1a;</p>\n<pre>***\n*** Error: Couldn&#39;t find an i386-ucore-elf version of GCC/binutils.\n*** Is the directory with i386-ucore-elf-gcc in your PATH?\n*** If your i386-ucore-elf toolchain is installed with a command\n*** prefix other than &#39;i386-ucore-elf-&#39;, set your GCCPREFIX\n*** environment variable to that prefix and run &#39;make&#39; again.\n*** To turn off this error, run &#39;gmake GCCPREFIX= ...&#39;.\n***</pre>\n<p>仔细一看&#xff0c;就是刚才那一段定义的某个else之后echo出来的内容。</p>\n<p></p>\n<p>2. Makefile (Cont.)</p>\n<p>从Lab3开始&#xff0c;我们发现一条有趣的命令&#xff1a;</p>\n<pre>$(SWAPIMG):\n\t$(V)dd if=/dev/zero of=$&#64; bs=1M count=128</pre>\n<p>在mac下&#xff0c;报错&#xff1a;</p>\n<pre>dd: bs: illegal numeric value</pre>\n<p>明显就是刚才dd那里某个参数有问题&#xff0c;查了下文档&#xff0c;发现mac下的bs的参数要用小写的m表示一兆&#xff0c;而linux的bs一般用大写的M表示一兆&#xff01;</p>\n<p>所以&#xff0c;我们改成这个样子</p>\n<pre>UNAME \t\t:= $(shell uname)\n\nifeq ($(UNAME), Darwin)\n\tBS=1m\nelse\n\tBS=1M\nendif\n\n$(SWAPIMG):\n\t$(V)dd if=/dev/zero of=$&#64; bs=$(BS) count=128</pre>\n<p>即特判一下OS是不是Darwin&#xff0c;从而选择1m或者1M。当然&#xff0c;这里我没有再考证其他的Unix以及除Ubuntu以外的Linux发行版。</p>\n<p></p>\n<p>3. grade.sh</p>\n<p>从Lab5开始&#xff0c;我们发现grade.sh也出现了奇怪了的命令&#xff1a;</p>\n<pre>select=&#96;expr substr $1 2 ${#1}&#96;</pre>\n<p>仔细查了一下expr的文档&#xff0c;发现什么substr根本就不是POSIX标准&#xff01;只能被某些特定的发行版支持&#xff0c;mac当然对此并不支持。所以&#xff0c;我们需要换成一个符合POSIX标准的等价命令&#xff1a;</p>\n<pre>select=&#96;echo $1 | cut -c 2-${#1}&#96;</pre>\n<p></p>\n<ul><li>参考答案有误</li></ul>\n<p>在lab6_result中&#xff0c;我发现了两个地方有问题&#xff1a;</p>\n<p></p>\n<p>1. 关于时钟中断的处理不全</p>\n<p>在lab6的trap.c中&#xff0c;我们发现这个lab需要做一点事情</p>\n<pre>/* you should upate you lab5 code\n * IMPORTANT FUNCTIONS:\n * sched_class_proc_tick\n */</pre>\n<p>大家就不要吐槽update拼写错误了&#xff0c;这种错误在ucore里面随处可见。然而看了答案&#xff0c;发现它闷声把这几行删了&#xff0c;而且所填写的代码和上次相比没有变化。仔细看了看实验指导书发现&#xff0c;这里确实是需要调sched.c里面</p>\n<pre>sched_class_proc_tick</pre>\n<p>函数的&#xff0c;然而这个函数似乎并不能直接调&#xff0c;因为它没有在头文件声明为外部文件可调用的函数&#xff0c;为此&#xff0c;我们不得不修改一下sched.c和sched.h来解决这个问题。</p>\n<p></p>\n<p>2. 有个大于号不太对</p>\n<p>还是在lab6&#xff0c;答案里面default_sched.c的第125行&#xff1a;</p>\n<pre>          if ((int32_t)(p-&gt;lab6_stride - q-&gt;lab6_stride) &gt; 0)\n               p = q;</pre>\n<p>有错&#xff0c;原因参见注释</p>\n<pre>(1.2) If using list, we have to search list to find the p with minimum stride value</pre>\n<p>是minimum呢。</p>\n<p></p>\n<p>以上是我发现的一些比较明显的问题&#xff0c;如果不解决就会导致代码编译不过或者make grade不通过的严重情况。很惭愧&#xff0c;只做了一点微小的工作&#xff01;如果大家发现新的坑可以继续发帖交流。</p>\n<p></p>"}], "type": "note", "tags": ["lab2", "lab3", "lab4", "lab5", "lab6", "lab7", "lab8", "student"], "tag_good": [{"role": "student", "name": "叶子鹏", "endorser": {}, "admin": false, "photo": null, "id": "i0f24oie8102cr", "photo_url": null, "published": true, "us": false, "class_sections": ["清华学生_i5j09fnsl7k5x0"], "facebook_id": null}, {"role": "instructor", "name": "Yong XIANG", "endorser": {}, "admin": true, "photo": null, "id": "hdjonbiyfs62ie", "photo_url": null, "us": false, "class_sections": ["课程设计_i5j09fnsl7k5x0", "清华学生_i5j09fnsl7k5x0", "所有老师和助教_i5j09fnsl7k5x0", "os2018spring_i5j09fnsl7k5x0"], "facebook_id": null}, {"role": "student", "name": "Long Haomin", "endorser": {}, "admin": false, "photo": null, "id": "i14g50r7ui12pn", "photo_url": null, "published": true, "us": false, "class_sections": ["课程设计_i5j09fnsl7k5x0", "清华学生_i5j09fnsl7k5x0"], "facebook_id": null}, {"role": "", "name": "Liu Xiaohong", "endorser": {}, "admin": false, "photo": null, "id": "i0ccfx63sir1e", "photo_url": null, "published": true, "us": false, "class_sections": ["清华学生_i5j09fnsl7k5x0"], "facebook_id": null}], "unique_views": 530, "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>赞&#xff0c;虽然我用的Windows</p>", "created": "2016-03-13T13:26:07Z", "bucket_order": 247, "bucket_name": "Week 3/13 - 3/19", "type": "followup", "tag_good": [], "uid": "i0f24oie8102cr", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "ilqlgz5xi7i1rd", "updated": "2016-03-13T13:26:07Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>请问一下lab1的makefile里面有个与terminal相关的参数</p>\n<p>TERMINAL = gome-terminal</p>\n<p>怎样去修改这个TERMINAL才能进行make&#xff08;即Mac下的TERMINAL应该是什么名字&#xff09;</p>\n<p>另外&#xff0c;qemu编译的时候它会告诉我这样的错误&#xff1a;</p>\n<p>dyld: Library not loaded: /usr/local/lib/libgnutls.28.dylib</p>\n<p>  Referenced from: /usr/local/bin/qemu-system-i386</p>\n<p>  Reason: image not found</p>\n<p>make: *** [qemu] Trace/BPT trap: 5</p>\n<p></p>\n<p>应该如何处理&#xff1f;</p>", "created": "2016-03-14T00:35:08Z", "bucket_order": 247, "bucket_name": "Week 3/13 - 3/19", "type": "followup", "tag_good": [], "uid": "i0zaci5voig5h", "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p>第一个问题我也遇到了&#xff0c;我没新开terminal&#xff0c;我直接在执行make的terminal里执行了。Mac下默认的那个是个app&#xff0c;好像你需要自己装一个非app的terminal。</p>", "created": "2016-03-14T00:46:25Z", "bucket_order": 247, "bucket_name": "Week 3/13 - 3/19", "type": "feedback", "tag_good": [], "uid": "i6w84pnmjCQ", "children": [], "tag_good_arr": [], "id": "ilr9rubmvn122p", "updated": "2016-03-14T00:46:25Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p>如果你不想装其他terminal&#xff0c;那么就开2个terminal工作&#xff0c;一个启动qemu&#xff0c;另一个开i386-elf-gdb连接1234端口&#xff08;好像是这个&#xff09;调试。所谓的make debug其实就是干了这两件事&#xff0c;并且把一些初始化的调试命令写好了。至于qemu编译的问题我就搞不清楚如何解决了&#xff0c;配环境是比写代码要复杂很多的工作啊&#xff01;</p>", "created": "2016-03-15T03:32:20Z", "bucket_order": 247, "bucket_name": "Week 3/13 - 3/19", "type": "feedback", "tag_good": [], "uid": "i0c1nsm3911wc", "children": [], "tag_good_arr": [], "id": "ilsv52qa43t10p", "updated": "2016-03-15T03:32:20Z", "config": {}}], "tag_good_arr": [], "no_answer": 0, "id": "ilr9dby2f867if", "updated": "2016-03-14T00:35:08Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>请教一下lab7,管程中的mutex到底是怎么作用的?它的value值为1时代表什么呢?是代表没有进程占用管程吗?那么问题是,当value值为0的时候如果调用了cond_wait函数,并且next_count为0时,按照注释应当唤醒一个等待在mutex的进程,但这时mutex并没有正在等待的进程,而mutex的value却会因此变成1,表示管程中没有进程,很明显这是不对的.</p>", "created": "2016-03-21T03:17:27Z", "bucket_order": 246, "bucket_name": "Week 3/20 - 3/26", "type": "followup", "tag_good": [], "uid": "ikvcvmzbvlf7i6", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "im1f91hyrf76jk", "updated": "2016-03-21T03:17:27Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>求问lab6中如果出现priority随机错误会是什么原因 .... ?</p>", "created": "2016-03-22T04:04:35Z", "bucket_order": 246, "bucket_name": "Week 3/20 - 3/26", "type": "followup", "tag_good": [], "uid": "i242q8ug7vw40x", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "im2wdi6jh875ts", "updated": "2016-03-22T04:04:35Z", "config": {}}], "tag_good_arr": ["i0f24oie8102cr", "hdjonbiyfs62ie", "i14g50r7ui12pn", "i0ccfx63sir1e"], "id": "ilql5g08ser5lt", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 10, "num_favorites": 10, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643168309371, "default_anonymity": "no"}, "error": null, "aid": "kyuzzhx7v8uul"}