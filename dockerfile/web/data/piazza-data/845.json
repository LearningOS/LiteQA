{"result": {"history_size": 3, "folders": ["lecture18"], "nr": 845, "data": {"embed_links": []}, "created": "2016-05-02T03:13:39Z", "bucket_order": 3, "no_answer_followup": 1, "change_log": [{"uid": "i0b77lptt0s2tg", "anon": "no", "when": "2016-05-02T03:13:39Z", "data": "inpflxo7dr7dg", "type": "create"}, {"uid": "i0b77lptt0s2tg", "anon": "no", "when": "2016-05-02T03:13:54Z", "data": "inpfm8yyida41r", "type": "update"}, {"to": "inpflxo3l1fdf", "uid": "i0f24oie8102cr", "anon": "no", "when": "2016-05-02T03:27:56Z", "type": "followup"}, {"uid": "i0b77lptt0s2tg", "anon": "no", "when": "2016-05-02T09:35:59Z", "data": "inpt9migidn111", "type": "update"}, {"to": "inpflxo3l1fdf", "uid": "hcrrjuyequh4bt", "anon": "no", "when": "2016-05-10T03:56:19Z", "type": "followup"}, {"to": "inpflxo3l1fdf", "uid": "hcrrjuyequh4bt", "anon": "no", "when": "2016-05-10T03:58:59Z", "type": "followup"}, {"to": "inpflxo3l1fdf", "uid": "i0b77lptt0s2tg", "anon": "no", "when": "2016-05-11T05:38:31Z", "type": "feedback"}, {"to": "inpflxo3l1fdf", "uid": "i0b77lptt0s2tg", "anon": "no", "when": "2016-05-11T05:40:11Z", "type": "feedback"}, {"to": "inpflxo3l1fdf", "uid": "i0f24oie8102cr", "anon": "no", "when": "2016-05-22T03:10:03Z", "type": "feedback"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "i0b77lptt0s2tg", "subject": "关于信号量和管程的等价关系以及个人理解", "created": "2016-05-02T09:35:59Z", "content": "<p>应陈渝老师要求&#xff0c;将课堂上关于信号量和管程的讨论记录如下&#xff0c;之前在piazza上的讨论详见 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=835\" target=\"_blank\">18.3管程视频疑问 </a> 以及 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=839\" target=\"_blank\">Semaphores vs Condition variables </a></p>\n<p></p>\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"6\"><tbody><tr><td><img width=\"463\" height=\"238\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6mkueclzr/信号量.JPG\" /></td><td><img width=\"387\" height=\"230\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6ncno39ec/管程.JPG\" /></td></tr><tr><td><img width=\"460\" height=\"229\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6nyeyvg94/信号量实现.JPG\" /></td><td><img width=\"462\" height=\"230\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6ojkfeivp/管程实现.JPG\" /></td></tr></tbody></table>\n<p></p>\n<p>如图&#xff0c;信号量中存有int变量sem以及WaitQueue变量q&#xff0c;根据信号量的实现代码&#xff08;左下角ppt&#xff09;&#xff0c;我们可以得出sem和q的含义&#xff1a;</p>\n<ol><li>q代表当前正在等待资源的线程组成的等待队列&#xff0c;若当前进程足够&#xff0c;q为空&#xff1b;</li><li>sem代表【到目前为止&#xff0c;若所有请求该资源的线程都能够获取该资源&#xff0c;那么资源还剩下多少&#xff08;这里我们假设资源个数可以为负&#xff09;】&#xff1b;</li><li>对sem的另一种理解&#xff1a;当sem非负时&#xff0c;sem代表剩余资源的个数&#xff1b;当sem为负数时&#xff0c;sem的绝对值代表等待队列q的长度。</li></ol>\n<p></p>\n<p>而当我们使用条件变量解决有限资源问题时&#xff0c;我们通常会在条件变量之外&#xff0c;管程之中加入整型变量count&#xff08;右上角ppt&#xff09;&#xff0c;来帮助条件变量记录当前剩余多少资源&#xff08;非负&#xff09;&#xff0c;查看条件变量的实现代码&#xff08;右下角ppt&#xff09;&#xff0c;我们可以得出条件变量中整型变量numWaiting以及WaitQueue变量q的含义&#xff1a;</p>\n<ol><li>q代表当前正在等待资源的线程组成的等待队列&#xff0c;若当前进程足够&#xff0c;q为空&#xff1b;</li><li>numWaiting代表等待队列q的长度&#xff08;非负&#xff09;。</li></ol>\n<p></p>\n<p>结合使用信号量以及条件变量解决有限资源问题的实例&#xff08;左上及右上ppt&#xff09;&#xff0c;以及以上我们对信号量和条件变量的分析&#xff0c;我们可以得出以下结论&#xff1a;</p>\n<ol><li>在任一状态&#xff0c;信号量中的q和条件变量中的q完全相同&#xff1b;</li><li>当sem非负时&#xff0c;含义与管程中的count相同&#xff0c;此时numWaiting为0&#xff1b;</li><li>当sem为负数时&#xff0c;sem的绝对值等于numWaiting&#xff0c;此时count为0。</li></ol>\n<p></p>\n<p>在生产者-消费者这个实例中&#xff0c;信号量emptyBuffers与条件变量notFull是匹配的&#xff0c;满足上面3个条件&#xff0c;此时count在代码中以n - count的形式出现&#xff1b;</p>\n<p>信号量fullBuffers与条件变量notEmpty是匹配的&#xff0c;满足上面3个条件&#xff0c;此时count在代码中以count的形式出现&#xff1b;</p>\n<p></p>\n<p>综上所述&#xff0c;两种解决方法是<strong>完全等价</strong>的&#xff0c;至于为什么用管程实现更加安全方便&#xff0c;个人认为老师在视频中并没有解释得很清楚&#xff0c;和老师讨论后得出结论如下&#xff1a;</p>\n<ol><li>用信号量的时候&#xff08;左上角ppt&#xff09;&#xff0c;所有信号量都要自己维护&#xff0c;并配对好PV&#xff1b;</li><li>用管程的时候&#xff0c;我们可以理解为BoundedBuffer继承了一个管程类&#xff0c;因此操作系统会给BoundedBuffer中每一个方法自动加上锁&#xff08;即右上角ppt中的lock-&gt;Acquire()和lock-&gt;Release()函数并不用自己写&#xff0c;是系统加上的&#xff09;&#xff0c;因此更加安全可控&#xff0c;容易查错。</li></ol>\n<p></p>\n<p>但是个人认为使用条件变量也要根据条件配对好Wait和Signal函数&#xff0c;因此不比使用信号量更容易安全&#xff0c;这个问题见仁见智吧&#xff0c;但如果考试时候问到怎么回答大家懂的~</p>\n<p></p>\n<p><strong>更新</strong>&#xff1a;ucore lab7 中实现信号量的 sem 值非负&#xff0c;这样看来 ucore 中信号量的 sem 值和条件变量中的 count 值应该是完全相等的。</p>"}, {"anon": "no", "uid": "i0b77lptt0s2tg", "subject": "关于信号量和管程的等价关系以及个人理解", "created": "2016-05-02T03:13:54Z", "content": "<p>应陈渝老师要求&#xff0c;将课堂上关于信号量和管程的讨论记录如下&#xff0c;之前在piazza上的讨论详见 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=835\" target=\"_blank\">18.3管程视频疑问 </a> 以及 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=839\" target=\"_blank\">Semaphores vs Condition variables </a></p>\n<p></p>\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"6\"><tbody><tr><td><img width=\"463\" height=\"238\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6mkueclzr/信号量.JPG\" /></td><td><img width=\"387\" height=\"230\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6ncno39ec/管程.JPG\" /></td></tr><tr><td><img width=\"460\" height=\"229\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6nyeyvg94/信号量实现.JPG\" /></td><td><img width=\"462\" height=\"230\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6ojkfeivp/管程实现.JPG\" /></td></tr></tbody></table>\n<p></p>\n<p>如图&#xff0c;信号量中存有int变量sem以及WaitQueue变量q&#xff0c;根据信号量的实现代码&#xff08;左下角ppt&#xff09;&#xff0c;我们可以得出sem和q的含义&#xff1a;</p>\n<ol><li>q代表当前正在等待资源的线程组成的等待队列&#xff0c;若当前进程足够&#xff0c;q为空&#xff1b;</li><li>sem代表【到目前为止&#xff0c;若所有请求该资源的线程都能够获取该资源&#xff0c;那么资源还剩下多少&#xff08;这里我们假设资源个数可以为负&#xff09;】&#xff1b;</li><li>对sem的另一种理解&#xff1a;当sem非负时&#xff0c;sem代表剩余资源的个数&#xff1b;当sem为负数时&#xff0c;sem的绝对值代表等待队列q的长度。</li></ol>\n<p></p>\n<p>而当我们使用条件变量解决有限资源问题时&#xff0c;我们通常会在条件变量之外&#xff0c;管程之中加入整型变量count&#xff08;右上角ppt&#xff09;&#xff0c;来帮助条件变量记录当前剩余多少资源&#xff08;非负&#xff09;&#xff0c;查看条件变量的实现代码&#xff08;右下角ppt&#xff09;&#xff0c;我们可以得出条件变量中整型变量numWaiting以及WaitQueue变量q的含义&#xff1a;</p>\n<ol><li>q代表当前正在等待资源的线程组成的等待队列&#xff0c;若当前进程足够&#xff0c;q为空&#xff1b;</li><li>numWaiting代表等待队列q的长度&#xff08;非负&#xff09;。</li></ol>\n<p></p>\n<p>结合使用信号量以及条件变量解决有限资源问题的实例&#xff08;左上及右上ppt&#xff09;&#xff0c;以及以上我们对信号量和条件变量的分析&#xff0c;我们可以得出以下结论&#xff1a;</p>\n<ol><li>在任一状态&#xff0c;信号量中的q和条件变量中的q完全相同&#xff1b;</li><li>当sem非负时&#xff0c;含义与管程中的count相同&#xff0c;此时numWaiting为0&#xff1b;</li><li>当sem为负数时&#xff0c;sem的绝对值等于numWaiting&#xff0c;此时count为0。</li></ol>\n<p></p>\n<p>在生产者-消费者这个实例中&#xff0c;信号量emptyBuffers与条件变量notFull是匹配的&#xff0c;满足上面3个条件&#xff0c;此时count在代码中以n - count的形式出现&#xff1b;</p>\n<p>信号量fullBuffers与条件变量notEmpty是匹配的&#xff0c;满足上面3个条件&#xff0c;此时count在代码中以count的形式出现&#xff1b;</p>\n<p></p>\n<p>综上所述&#xff0c;两种解决方法是<strong>完全等价</strong>的&#xff0c;至于为什么用管程实现更加安全方便&#xff0c;个人认为老师在视频中并没有解释得很清楚&#xff0c;和老师讨论后得出结论如下&#xff1a;</p>\n<ol><li>用信号量的时候&#xff08;左上角ppt&#xff09;&#xff0c;所有信号量都要自己维护&#xff0c;并配对好PV&#xff1b;</li><li>用管程的时候&#xff0c;我们可以理解为BoundedBuffer继承了一个管程类&#xff0c;因此操作系统会给BoundedBuffer中每一个方法自动加上锁&#xff08;即右上角ppt中的lock-&gt;Acquire()和lock-&gt;Release()函数并不用自己写&#xff0c;是系统加上的&#xff09;&#xff0c;因此更加安全可控&#xff0c;容易查错。</li></ol>\n<p></p>\n<p>但是个人认为使用条件变量也要根据条件配对好Wait和Signal函数&#xff0c;因此不比使用信号量更容易安全&#xff0c;这个问题见仁见智吧&#xff0c;但如果考试时候问到怎么回答大家懂的~</p>"}, {"anon": "no", "uid": "i0b77lptt0s2tg", "subject": "关于信号量和管程的等价关系以及个人理解", "created": "2016-05-02T03:13:39Z", "content": "<p>应陈渝老师要求&#xff0c;将课堂上关于信号量和管程的讨论记录如下&#xff0c;之前在piazza上的讨论详见 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=835\" target=\"_blank\">18.3管程视频疑问 </a> 以及 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=839\" target=\"_blank\">Semaphores vs Condition variables </a></p>\n<p></p>\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"6\"><tbody><tr><td><img width=\"463\" height=\"238\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6mkueclzr/信号量.JPG\" /></td><td><img width=\"387\" height=\"230\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6ncno39ec/管程.JPG\" /></td></tr><tr><td><img width=\"460\" height=\"229\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6nyeyvg94/信号量实现.JPG\" /></td><td><img width=\"462\" height=\"230\" src=\"https://d1b10bmlvqabco.cloudfront.net/attach/i5j09fnsl7k5x0/i0b77lptt0s2tg/ing6ojkfeivp/管程实现.JPG\" /></td></tr></tbody></table>\n<p></p>\n<p>如图&#xff0c;信号量中存有int变量sem以及WaitQueue变量q&#xff0c;根据信号量的实现代码&#xff08;左下角ppt&#xff09;&#xff0c;我们可以得出sem和q的含义&#xff1a;</p>\n<ol><li>q代表当前正在等待资源的线程组成的等待队列&#xff0c;若当前进程足够&#xff0c;q为空&#xff1b;</li><li>sem代表【到目前为止&#xff0c;若所有请求该资源的线程都能够获取该资源&#xff0c;那么资源还剩下多少&#xff08;这里我们假设资源个数可以为负&#xff09;】&#xff1b;</li><li>对sem的另一种理解&#xff1a;当sem非负时&#xff0c;sem代表剩余资源的个数&#xff1b;当sem为负数时&#xff0c;sem的绝对值代表等待队列q的长度。</li></ol>\n<p></p>\n<p>而当我们使用条件变量解决有限资源问题时&#xff0c;我们通常会在条件变量之外&#xff0c;管程之中加入整型变量count&#xff08;右上角ppt&#xff09;&#xff0c;来帮助条件变量记录当前剩余多少资源&#xff08;非负&#xff09;&#xff0c;查看条件变量的实现代码&#xff08;右下角ppt&#xff09;&#xff0c;我们可以得出条件变量中整型变量numWaiting以及WaitQueue变量q的含义&#xff1a;</p>\n<ol><li>q代表当前正在等待资源的线程组成的等待队列&#xff0c;若当前进程足够&#xff0c;q为空&#xff1b;</li><li>numWaiting代表等待队列q的长度&#xff08;非负&#xff09;。</li></ol>\n<p></p>\n<p>结合使用信号量以及条件变量解决有限资源问题的实例&#xff08;左上及右上ppt&#xff09;&#xff0c;以及以上我们对信号量和条件变量的分析&#xff0c;我们可以得出以下结论&#xff1a;</p>\n<ol><li>在任一状态&#xff0c;信号量中的q和条件变量中的q完全相同&#xff1b;</li><li>当sem非负时&#xff0c;含义与管程中的count相同&#xff0c;此时numWaiting为0&#xff1b;</li><li>当sem为负数时&#xff0c;sem的绝对值等于numWaiting&#xff0c;此时count为0。</li></ol>\n<p></p>\n<p>在生产者-消费者这个实例中&#xff0c;信号量emptyBuffers与条件变量notFull是匹配的&#xff0c;满足上面3个条件&#xff0c;此时count在代码中以n - count的形式出现&#xff1b;</p>\n<p>信号量fullBuffers与条件变量notEmpty是匹配的&#xff0c;满足上面3个条件&#xff0c;此时count在代码中以count的形式出现&#xff1b;</p>\n<p></p>\n<p>综上所述&#xff0c;两种解决方法是<strong>完全等价</strong>的&#xff0c;至于为什么用管程实现更加安全方便&#xff0c;个人认为老师在视频中并没有解释得很清楚&#xff0c;和老师讨论后得出结论如下&#xff1a;</p>\n<ol><li>用信号量的时候&#xff08;左上角ppt&#xff09;&#xff0c;所有信号量都要自己维护&#xff0c;并配对好PV&#xff1b;</li><li>用管程的时候&#xff0c;我们可以理解为BoundedBuffer继承了一个管程类&#xff0c;因此操作系统会给BoundedBuffer中每一个方法自动加上锁&#xff08;即右上角ppt中的lock-&gt;Acquire()和lock-&gt;Release()函数并不用自己写&#xff0c;是系统加上的&#xff09;&#xff0c;因此更加安全可控&#xff0c;容易查错。</li></ol>\n<p></p>\n<p>但是个人认为使用条件变量也要根据条件配对好Wait和Signal函数&#xff0c;因此不比使用信号量更容易安全&#xff0c;这个问题见仁见智吧&#xff0c;但如果考试时候问到怎么回答大家懂的~</p>"}], "type": "note", "tags": ["lecture18", "student", "unanswered"], "tag_good": [{"role": "student", "name": "叶子鹏", "endorser": {}, "admin": false, "photo": null, "id": "i0f24oie8102cr", "photo_url": null, "published": true, "us": false, "class_sections": ["清华学生_i5j09fnsl7k5x0"], "facebook_id": null}, {"role": "", "name": "Liu Xiaohong", "endorser": {}, "admin": false, "photo": null, "id": "i0ccfx63sir1e", "photo_url": null, "published": true, "us": false, "class_sections": ["清华学生_i5j09fnsl7k5x0"], "facebook_id": null}, {"role": "instructor", "name": "Yu Chen", "endorser": {}, "admin": true, "photo": "1378950179_35.png", "id": "hcrrjuyequh4bt", "photo_url": "https://cdn-uploads.piazza.com/photos/hcrrjuyequh4bt/1378950179_35.png", "us": false, "class_sections": ["课程设计_i5j09fnsl7k5x0", "清华学生_i5j09fnsl7k5x0", "所有老师和助教_i5j09fnsl7k5x0", "os2018spring_i5j09fnsl7k5x0"], "facebook_id": null}], "unique_views": 189, "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>点个赞&#xff0c;但是我还是觉得&#xff0c;如果没有一个简单的机制&#xff0c;让我们如果申请不到资源2就放弃资源1&#xff0c;就会导致控制复杂度随着资源种类的增加而增加</p>", "created": "2016-05-02T03:27:55Z", "bucket_order": 271, "bucket_name": "Week 5/1 - 5/7", "type": "followup", "tag_good": [], "uid": "i0f24oie8102cr", "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p>突然看到我之前的回复&#xff0c;发现确实同步互斥和死锁不能一起讲&#xff0c;我建议老师把哲学家就餐问题从同步互斥中去掉&#xff0c;加入死锁中</p>", "created": "2016-05-22T03:10:03Z", "bucket_order": 268, "bucket_name": "Week 5/22 - 5/28", "type": "feedback", "tag_good": [], "uid": "i0f24oie8102cr", "children": [], "tag_good_arr": [], "id": "ioi0acmp4xs4q5", "updated": "2016-05-22T03:10:03Z", "config": {}}], "tag_good_arr": [], "no_answer": 0, "id": "inpg4ajhcae1d2", "updated": "2016-05-02T03:27:55Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>疑问&#xff1a;</p>\n<p></p>\n<p>semaphore.V在执行中都会对某个整型变量&#xff0b;1</p>\n<p>condition_var.Signal在执行中不一定会对某个整型变量&#43;1</p>\n<p></p>\n<p>这使得在二者的执行逻辑上会有不同&#xff0c;所以二者在具体实现上是不等价的?</p>", "created": "2016-05-10T03:56:19Z", "bucket_order": 270, "bucket_name": "Week 5/8 - 5/14", "type": "followup", "tag_good": [], "uid": "hcrrjuyequh4bt", "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p>从这个角度讲他们是不等价的。</p>", "created": "2016-05-11T05:38:31Z", "bucket_order": 270, "bucket_name": "Week 5/8 - 5/14", "type": "feedback", "tag_good": [], "uid": "i0b77lptt0s2tg", "children": [], "tag_good_arr": [], "id": "io2fqws6qy55lk", "updated": "2016-05-11T05:38:31Z", "config": {}}], "tag_good_arr": [], "no_answer": 0, "id": "io0wnlxn8ly580", "updated": "2016-05-10T03:56:19Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>我理解的等价是指&#xff1a;信号量可以实现管程&#xff0c;管程可以实现信号量&#xff0c;所以在这个层面&#xff0c;二者等价&#xff0e;</p>\n<p></p>\n<p>疑问&#xff1a;</p>\n<p>Test&amp;Set原子操作是否可以实现Exchange原子操作? Exchange原子操作是否可以实现Test&amp;Set原子操作?</p>", "created": "2016-05-10T03:58:59Z", "bucket_order": 270, "bucket_name": "Week 5/8 - 5/14", "type": "followup", "tag_good": [], "uid": "hcrrjuyequh4bt", "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p>Exchange 操作是 read-modified-write</p>\n<p>Test-and-set 操作也是 read-modified-write</p>\n<p>不是很明白这两个原子操作有什么区别&#xff1f;只是位数的区别吗&#xff1f;&#xff08;Test-and-set 只有1位&#xff0c; 然而 exchange 可以多位&#xff1f;&#xff09;</p>", "created": "2016-05-11T05:40:11Z", "bucket_order": 270, "bucket_name": "Week 5/8 - 5/14", "type": "feedback", "tag_good": [], "uid": "i0b77lptt0s2tg", "children": [], "tag_good_arr": [], "id": "io2ft1lnaih735", "updated": "2016-05-11T05:40:11Z", "config": {}}], "tag_good_arr": [], "no_answer": 1, "id": "io0wr1izxh915", "updated": "2016-05-10T03:58:59Z", "config": {}}], "tag_good_arr": ["i0f24oie8102cr", "i0ccfx63sir1e", "hcrrjuyequh4bt"], "id": "inpflxo3l1fdf", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 6, "num_favorites": 5, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643168615819, "default_anonymity": "no"}, "error": null, "aid": "kyv062dngtt5fu"}