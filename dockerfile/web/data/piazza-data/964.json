{"result": {"folders": ["lecture2"], "nr": 964, "data": {"embed_links": []}, "created": "2017-02-05T04:27:29Z", "bucket_order": 3, "no_answer_followup": 1, "change_log": [{"anon": "no", "uid": "iljibip7aRz", "data": "iys63k4wawc1g2", "type": "create", "when": "2017-02-05T04:27:29Z"}, {"anon": "no", "uid": "hcrrjuyequh4bt", "data": "izj6e3nscex36n", "to": "iys63k4s8eg1g1", "type": "i_answer", "when": "2017-02-24T02:05:28Z"}, {"anon": "no", "uid": "hcrrjuyequh4bt", "data": "izj7142at1y1bl", "type": "i_answer_update", "when": "2017-02-24T02:23:22Z"}, {"anon": "no", "uid": "hcrrjuyequh4bt", "to": "iys63k4s8eg1g1", "type": "followup", "when": "2017-02-24T02:33:28Z"}, {"anon": "no", "uid": "j8z934beR2C", "to": "iys63k4s8eg1g1", "type": "followup", "when": "2017-10-20T03:05:15Z"}, {"anon": "no", "uid": "i9nq03ifdK9", "to": "iys63k4s8eg1g1", "type": "followup", "when": "2018-09-10T16:27:13Z"}, {"anon": "no", "uid": "j8otw57hSIW", "to": "iys63k4s8eg1g1", "type": "feedback", "when": "2018-11-13T17:33:18Z"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "iljibip7aRz", "subject": "编译出错", "created": "2017-02-05T04:27:29Z", "content": "<p>编译出错</p>\n<p>编译labcodes_answer/lab1_result&#xff0c;使用编译命令&#96;make&#96;编译出错</p>\n<p>错误代码&#xff1a;</p>\n<p>&#43; ld bin/bootblock</p>\n<p>&#39;obj/bootblock.out&#39; size: 620 bytes</p>\n<p>620 &gt;&gt; 510!!</p>\n<p>Makefile:152: recipe for target &#39;bin/bootblock&#39; failed</p>\n<p>make: *** [bin/bootblock] Error 255</p>\n<p>为什么会编译出620字节呢&#xff1f;</p>\n<p>我没有对代码做任何修改&#xff0c;就是从github clone陈瑜老师的源码</p>\n<p>是我的gcc版本太新吗&#xff1f;</p>\n<p>gcc version 6.2.0 20161103 (Debian 6.2.0-11)</p>\n<p>labcodes_answer/lab2_result没有出现这个问题</p>"}], "type": "question", "tags": ["lecture2", "student"], "tag_good": [{"role": "instructor", "name": "Yu Chen", "endorser": {}, "admin": true, "photo": "1378950179_35.png", "id": "hcrrjuyequh4bt", "photo_url": "https://d1b10bmlvqabco.cloudfront.net/photos/hcrrjuyequh4bt/1378950179_35.png", "us": false, "class_sections": ["课程设计_i5j09fnsl7k5x0", "清华学生_i5j09fnsl7k5x0", "所有老师和助教_i5j09fnsl7k5x0", "os2018spring_i5j09fnsl7k5x0"], "facebook_id": null}], "unique_views": 207, "children": [{"folders": [], "data": {"embed_links": []}, "children": [], "created": "2017-02-24T02:05:28Z", "bucket_order": 3, "tag_endorse": [], "bucket_name": "Today", "id": "izj6e3nmt7g36m", "history": [{"anon": "no", "uid": "hcrrjuyequh4bt", "subject": "", "created": "2017-02-24T02:23:22Z", "content": "<p>对&#xff0c;以前碰到过gcc版本太新造成编译超过510字节的情况。</p>\n<p>但应该通过某种方法解决吧&#xff0c;不知哪位牛同学能给出建议或方法&#xff1f;</p>\n<p></p>"}, {"anon": "no", "uid": "hcrrjuyequh4bt", "subject": "", "created": "2017-02-24T02:05:28Z", "content": "<p>对&#xff0c;以前碰到过gcc版本太新造成编译超过510字节的情况。</p>"}], "type": "i_answer", "tag_endorse_arr": [], "config": {}, "is_tag_endorse": false}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>我的解决办法:</p>\n<p>sudo apt install gcc-4.9-multilib</p>\n<p></p>\n<p>修改lab1_result的Makefile</p>\n<p></p>\n<p>-HOSTCC         := gcc<br />-HOSTCFLAGS     := -g -Wall -O2<br />&#43;HOSTCC         := gcc-4.9<br />&#43;HOSTCFLAGS     := -g -Wall -O2 -s<br /> <br />-CC             := $(GCCPREFIX)gcc<br />-CFLAGS := -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc $(DEFS)<br />&#43;#CC            := $(GCCPREFIX)gcc<br />&#43;CC             := gcc-4.9<br />&#43;CFLAGS := -fno-builtin -Wall -ggdb -s -m32 -gstabs -nostdinc $(DEFS)<br /><br /></p>\n<p>再次编译。OK&#xff01;</p>", "created": "2017-02-24T02:33:28Z", "bucket_order": 193, "bucket_name": "Week 2/19 - 2/25", "type": "followup", "tag_good": [], "uid": "hcrrjuyequh4bt", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "izj7e4b0v1z14i", "updated": "2017-02-24T02:33:28Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>表示我也遇到了这个问题&#xff0c;回去按这个试试吧。</p>", "created": "2017-10-20T03:05:15Z", "bucket_order": 159, "bucket_name": "Week 10/15 - 10/21", "type": "followup", "tag_good": [], "uid": "j8z934beR2C", "children": [], "tag_good_arr": [], "no_answer": 1, "id": "j8zbbq7dez719s", "updated": "2017-10-20T03:05:15Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>我也遇到了这个问题。我的环境是Ubuntu 18.04 LTS, gcc version 7.3.0</p>\n<p></p>\n<p>首先我使用objdump检查了课程虚拟机与我自己环境产生的bootblock.o的区别&#xff0c;发现其产生了多余的类似于__x86.get_pc_thunk.di的代码&#xff0c;搜索之后发现它与PIC有关。</p>\n<p></p>\n<p>于是我在CFLAGS里上了-fno-pic的编译选项&#xff0c;问题解决。</p>\n<p></p>\n<p>但lab2的代码没这个问题&#xff0c;经检查发现bootmain.c里的</p>\n<div>\n<div>unsigned int SECTSIZE = 512 ;</div>\n<div>struct elfhdr * ELFHDR = ((struct elfhdr *)0x10000) ; // scratch space</div>\n变成了</div>\n<div>\n<div>\n<div>#define SECTSIZE 512</div>\n<div>#define ELFHDR ((struct elfhdr *)0x10000) // scratch space</div>\n</div>\n<div>可能是这个原因导致在新版gcc上产生了PIC。所以可以不改编译选项&#xff0c;直接改这两句话就可以了。</div>\n<div></div>\n<div>但是我在Ubuntu 18.04上make qemu的时候运行有问题&#xff0c;搞了半天都不知道怎么解决&#xff0c;感觉上是lab1的kernel有问题。</div>\n<div></div>\n<div>报错如下&#xff1a;</div>\n<div></div>\n<div>WARNING: Image format was not specified for &#39;bin/ucore.img&#39; and probing guessed raw.<br /> Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.<br /> Specify the &#39;raw&#39; format explicitly to remove the restrictions.<br />(THU.CST) os is loading ...<br /><br />Special kernel symbols:<br /> entry 0x00100000 (phys)<br /> etext 0x00103ada (phys)<br /> edata 0x0010f950 (phys)<br /> end 0x00110e20 (phys)<br />Kernel executable memory footprint: 68KB<br />ebp:0x00007b38 eip:0x00100bf3 args:0x00010094 0x0010f950 0x00007b68 0x001000a7 <br /> kern/debug/kdebug.c:305: print_stackframe&#43;33<br />ebp:0x00007b48 eip:0x00100f74 args:0x00000000 0x00000000 0x00000000 0x00100092 <br /> kern/debug/kmonitor.c:125: mon_backtrace&#43;23<br />ebp:0x00007b68 eip:0x001000a7 args:0x00000000 0x00007b90 0xffff0000 0x00007b94 <br /> kern/init/init.c:48: grade_backtrace2&#43;32<br />ebp:0x00007b88 eip:0x001000d6 args:0x00000000 0xffff0000 0x00007bb4 0x001000ea <br /> kern/init/init.c:53: grade_backtrace1&#43;37<br />ebp:0x00007ba8 eip:0x001000fd args:0x00000000 0x00100000 0xffff0000 0x0010010e <br /> kern/init/init.c:58: grade_backtrace0&#43;29<br />ebp:0x00007bc8 eip:0x00100129 args:0x00000000 0x00000000 0x00000000 0x00103adc <br /> kern/init/init.c:63: grade_backtrace&#43;37<br />ebp:0x00007be8 eip:0x00100066 args:0x00000000 0x00000000 0x00000000 0x00007c4f <br /> kern/init/init.c:28: kern_init&#43;101<br />ebp:0x00007bf8 eip:0x00007d6e args:0xc031fcfa 0xc08ed88e 0x64e4d08e 0xfa7502a8 <br /> &lt;unknow&gt;: -- 0x00007d6d --<br />(THU.CST) os is loading ...<br /><br />Special kernel symbols:<br /> entry 0x00100000 (phys)<br /> etext 0x00103ada (phys)<br /> edata 0x0010f950 (phys)<br /> end 0x00110e20 (phys)<br />Kernel executable memory footprint: 68KB</div>\n</div>", "created": "2018-09-10T16:27:13Z", "bucket_order": 112, "bucket_name": "Week 9/9 - 9/15", "type": "followup", "tag_good": [], "uid": "i9nq03ifdK9", "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p>感谢&#xff0c;这真的解决了我的问题&#xff01;</p>", "created": "2018-11-13T17:33:18Z", "bucket_order": 103, "bucket_name": "Week 11/11 - 11/17", "type": "feedback", "tag_good": [], "uid": "j8otw57hSIW", "children": [], "tag_good_arr": [], "id": "jog0meyt6bc1j1", "updated": "2018-11-13T17:33:18Z", "config": {}}], "tag_good_arr": [], "no_answer": 0, "id": "jlwi2wnl46k2ut", "updated": "2018-09-10T16:27:13Z", "config": {}}], "tag_good_arr": ["hcrrjuyequh4bt"], "no_answer": 0, "id": "iys63k4s8eg1g1", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 8, "num_favorites": 2, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643168878170, "default_anonymity": "no"}, "error": null, "aid": "kyv0bot6jew6kg"}