{"result": {"folders": ["2017", "lecture14", "课堂问答"], "nr": 1045, "data": {"embed_links": []}, "created": "2017-04-14T05:30:27Z", "bucket_order": 3, "no_answer_followup": 1, "change_log": [{"anon": "no", "uid": "hdjonbiyfs62ie", "data": "j1heag92t182x6", "type": "create", "when": "2017-04-14T05:30:27Z"}, {"anon": "no", "uid": "jslfact6jvaN", "to": "j1heag8ztzh2x5", "type": "followup", "when": "2019-04-17T12:53:54Z"}, {"anon": "no", "uid": "jslfact6jvaN", "to": "j1heag8ztzh2x5", "type": "feedback", "when": "2019-04-17T13:21:50Z"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "hdjonbiyfs62ie", "subject": "2017春季-第十四讲课堂实践练习(1)", "created": "2017-04-14T05:30:27Z", "content": "<p>请两人一组完成“第十四讲 实验五 用户进程管理”中指定小题的回答在此贴中回复&#xff0c;每组同学选做一个题目。<br /> <br />题目&#xff1a;<br /><a href=\"https://chyyuu.gitbooks.io/os_course_exercises/content/all/05-4-lab5-spoc-discussion.html\">https://chyyuu.gitbooks.io/os_course_exercises/content/all/05-4-lab5-spoc-discussion.html</a></p>\n<p></p>\n<p>视频相关思考题 -&gt; 14.2 进程的内存布局 -&gt; 第2小题</p>\n<p></p>\n<p>尝试在panic函数中获取并输出用户栈和内核栈的函数嵌套信息和函数调用参数信息&#xff0c;然后在你希望的地方人为触发panic函数&#xff0c;并输出上述信息。</p>"}], "type": "note", "tags": ["2017", "instructor-note", "lecture14", "课堂问答"], "tag_good": [], "unique_views": 86, "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>占坑</p>\n<p></p>", "created": "2019-04-17T12:53:54Z", "bucket_order": 55, "bucket_name": "Week 4/14 - 4/20", "type": "followup", "tag_good": [], "uid": "jslfact6jvaN", "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p></p>\n<p>在kern/trap/trap.c中的trap_dispatch函数中加入&#xff1a;</p>\n<pre>if(!trap_in_kernel(tf)){\n    panic(&#34;trap&#34;);\n}</pre>\n<p>然后在kern/debug/panic.c中的__panic()函数中加入&#xff1a;</p>\n<pre>print_stackframe();</pre>\n<p>则会在第一次从用户态进行系统调用时执行panic函数并输出用户栈和内核栈的函数嵌套和调用信息。输出如下&#xff1a;</p>\n<pre>kernel_execve: pid = 2, name = &#34;exit&#34;.\nkernel panic at kern/trap/trap.c:199:\n    trap\nstack trackback:\nebp:0xc03adf28 eip:0xc0101ed8 args:0xc010c216 0x0000000a 0xc03adf90 0xc03adf5c \n    kern/debug/kdebug.c:350: print_stackframe&#43;21\nebp:0xc03adf48 eip:0xc01017d4 args:0xc010d040 0x000000c7 0xc010d068 0xc03adfb4 \n    kern/debug/panic.c:27: __panic&#43;107\nebp:0xc03adf78 eip:0xc0103a76 args:0xc03adfb4 0x00000000 0x00000023 0x00000023 \n    kern/trap/trap.c:199: trap_dispatch&#43;50\nebp:0xc03adfa8 eip:0xc0103ce9 args:0xc03adfb4 0x00000049 0x00000000 0xaffffea8 \n    kern/trap/trap.c:291: trap&#43;80\nebp:0xaffffea8 eip:0xc01047b3 args:0x0000001e 0x00000049 0xaffffed8 0x00800254 \n    kern/trap/trapentry.S:24: &lt;unknown&gt;&#43;0\nebp:0xaffffeb8 eip:0x0080017e args:0x00000049 0x00000000 0x00000000 0x00000000 \n    user/libs/syscall.c:65: sys_putc&#43;12\nebp:0xaffffed8 eip:0x00800254 args:0x00000049 0xafffff3c 0x00000000 0x00000000 \n    user/libs/stdio.c:11: cputch&#43;16\nebp:0xafffff18 eip:0x008009a2 args:0x00800243 0xafffff3c 0x00801321 0xafffff84 \n    libs/printfmt.c:131: vprintfmt&#43;29\nebp:0xafffff48 eip:0x00800288 args:0x00801320 0xafffff84 0x00000000 0x00000000 \n    user/libs/stdio.c:27: vcprintf&#43;32\nebp:0xafffff78 eip:0x008002ab args:0x00801320 0x00000000 0x00000000 0x00000000 \n    user/libs/stdio.c:42: cprintf&#43;26\nebp:0xafffffa8 eip:0x00800f05 args:0x00000000 0x00000000 0x00000000 0x0080030f \n    user/exit.c:9: main&#43;29\nebp:0xafffffd8 eip:0x0080030f args:0x00000000 0x00000000 0x00000000 0x00000000 \n    user/libs/umain.c:7: umain&#43;10</pre>\n<p>可以看到在上面的例子中&#xff0c;在用户态执行第一次cprintf函数时触发了该panic。</p>\n<p>如果想在其他位置输出&#xff0c;可以在对应位置调用panic函数</p>", "created": "2019-04-17T13:21:50Z", "bucket_order": 55, "bucket_name": "Week 4/14 - 4/20", "type": "feedback", "tag_good": [], "uid": "jslfact6jvaN", "children": [], "tag_good_arr": [], "id": "jul8w25a58h3zg", "updated": "2019-04-17T13:21:50Z", "config": {}}], "tag_good_arr": [], "no_answer": 1, "id": "jul7w5bilo26is", "updated": "2019-04-17T12:53:54Z", "config": {}}], "tag_good_arr": [], "id": "j1heag8ztzh2x5", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 2, "num_favorites": 0, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643169027495, "default_anonymity": "no"}, "error": null, "aid": "kyv0ew13kjk4oi"}