{"result": {"folders": ["lab8"], "nr": 1231, "data": {"embed_links": []}, "created": "2018-05-20T00:57:42Z", "bucket_order": 3, "no_answer_followup": 0, "change_log": [{"anon": "no", "uid": "isycnlmpuv26l6", "data": "jhe44a3wc392et", "type": "create", "when": "2018-05-20T00:57:42Z"}, {"anon": "no", "uid": "isu0wqaoff5125", "to": "jhe44a3toyf2es", "type": "followup", "when": "2018-05-20T06:25:29Z"}, {"anon": "no", "uid": "hcrrjuyequh4bt", "data": "jhfz1r1lmwl4px", "to": "jhe44a3toyf2es", "type": "i_answer", "when": "2018-05-21T08:11:18Z"}, {"anon": "no", "uid": "hcrrjuyequh4bt", "data": "jhfz3uo2b584", "type": "i_answer_update", "when": "2018-05-21T08:12:56Z"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "isycnlmpuv26l6", "subject": "关于sfs_lookup问题", "created": "2018-05-20T00:57:42Z", "content": "<p>lab8的实验指导书中原文说到&#xff1a;</p>\n<p>Sfs_lookup函数以“/”为分割符,从左至右逐一分解path获得各个子目录和最终文件对应的inode节点。</p>\n<p>但对应的sfs_lookup代码为&#xff1a;</p>\n<pre>static int<br />sfs_lookup(struct inode *node, char *path, struct inode **node_store) {<br />    struct sfs_fs *sfs = fsop_info(vop_fs(node), sfs);<br />    assert(*path != &#39;\\0&#39; &amp;&amp; *path != &#39;/&#39;);<br />    vop_ref_inc(node);<br />    struct sfs_inode *sin = vop_info(node, sfs_inode);<br />    if (sin-&gt;din-&gt;type != SFS_TYPE_DIR) {<br />        vop_ref_dec(node);<br />        return -E_NOTDIR;<br />    }<br />    struct inode *subnode;<br />    int ret = sfs_lookup_once(sfs, sin, path, &amp;subnode, NULL);<br /><br />    vop_ref_dec(node);<br />    if (ret != 0) {<br />        return ret;<br />    }<br />    *node_store = subnode;<br />    return 0;<br />}</pre>\n<p>在函数中没有任何递归或循环&#xff0c;也没有对path进行处理&#xff0c;直接调用了sfs_lookup_once函数&#xff0c;而sfs_lookup_once函数只会继续加锁调用sfs_dirent_search_nolock函数&#xff0c;遍历文件夹对应inode&#xff0c;用strcmp找出名字一致的文件或文件夹。</p>\n<p>这么看的话&#xff0c;sfs_lookup其实只能进行一层深度的查找&#xff0c;无法进行递归查找。不知道我是否遗漏了一些重要执行步骤&#xff0c;还请老师指教。</p>"}], "type": "question", "tags": ["lab8", "student"], "tag_good": [], "unique_views": 135, "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>我认为您说的很有道理。。。</p>", "created": "2018-05-20T06:25:29Z", "bucket_order": 107, "bucket_name": "Week 5/20 - 5/26", "type": "followup", "tag_good": [], "uid": "isu0wqaoff5125", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "jhefttlx9wdog", "updated": "2018-05-20T06:25:29Z", "config": {}}, {"folders": [], "data": {"embed_links": []}, "children": [], "created": "2018-05-21T08:11:18Z", "bucket_order": 3, "tag_endorse": [{"role": "student", "name": "Wende Tan", "endorser": {}, "admin": false, "photo": null, "id": "isu0wqaoff5125", "photo_url": null, "published": true, "us": false, "class_sections": ["os2018spring_i5j09fnsl7k5x0"], "facebook_id": null}, {"role": "student", "name": "Zhu Fangwei", "endorser": {}, "admin": false, "photo": null, "id": "isycnlmpuv26l6", "photo_url": null, "published": true, "us": false, "class_sections": ["os2018spring_i5j09fnsl7k5x0"], "facebook_id": null}], "bucket_name": "Today", "id": "jhfz1r1d1kt4pw", "history": [{"anon": "no", "uid": "hcrrjuyequh4bt", "subject": "", "created": "2018-05-21T08:12:56Z", "content": "<p>&#64;Zhu Fangwei 你看的很仔细&#xff01;</p>\n<p>在ucore_plus中&#xff0c;sfs_lookup有对sfs_lookup_once函数的循环调用。</p>\n<p>在ucore_lab中&#xff0c;为简化处理逻辑&#xff0c;sfs_lookup只有对sfs_lookup_once函数的一次调用&#xff0c;这使得lab8只能应对一层目录。注:la8实验并不要求能够处理多级目录。</p>\n<p></p>\n<p>文档已改进。code也改进了一下&#xff0c;加了一个sfs的简单测试用例。可访问&#xff1a;</p>\n<p><a href=\"https://github.com/chyyuu/ucore_os_docs\">https://github.com/chyyuu/ucore_os_docs</a></p>\n<p>https://github.com/chyyuu/ucore_os_lab</p>"}, {"anon": "no", "uid": "hcrrjuyequh4bt", "subject": "", "created": "2018-05-21T08:11:18Z", "content": "<p>&#64;Zhu Fangwei 你看的很仔细&#xff01;</p>\n<p>在ucore_plus中&#xff0c;sfs_lookup有对sfs_lookup_once函数的循环调用。</p>\n<p>在ucore_lab中&#xff0c;为简化处理逻辑&#xff0c;sfs_lookup只有对sfs_lookup_once函数的一次调用&#xff0c;这使得lab8只有一层目录。</p>\n<p></p>\n<p>文档已改进。code也改进了一下&#xff0c;加了一个sfs的简单测试用例。可访问&#xff1a;</p>\n<p><a href=\"https://github.com/chyyuu/ucore_os_docs\">https://github.com/chyyuu/ucore_os_docs</a></p>\n<p>https://github.com/chyyuu/ucore_os_lab</p>"}], "type": "i_answer", "tag_endorse_arr": ["isu0wqaoff5125", "isycnlmpuv26l6"], "config": {}, "is_tag_endorse": false}], "tag_good_arr": [], "no_answer": 0, "id": "jhe44a3toyf2es", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 3, "num_favorites": 0, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643169463032, "default_anonymity": "no"}, "error": null, "aid": "kyv0o83clgl5kb"}