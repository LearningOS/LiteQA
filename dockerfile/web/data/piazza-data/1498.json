{"result": {"folders": ["lab7"], "nr": 1498, "data": {"embed_links": []}, "created": "2020-10-15T12:57:53Z", "bucket_order": 3, "no_answer_followup": 0, "change_log": [{"anon": "no", "uid": "k6hcv6bd7p44a2", "data": "kgatw7y9ka93a1", "v": "all", "type": "create", "when": "2020-10-15T12:57:53Z"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "k6hcv6bd7p44a2", "subject": "关于lab7中timer的疑问", "created": "2020-10-15T12:57:53Z", "content": "<p><md>我不太理解这个timer的相关操作，这里的expire是代表着剩余多久被唤醒吗？它的几个相关操作函数为什么要这样设计？我拿do_sleep函数举例\n在do_sleep里面调用了schedule之后会在它的expire变为0时返回这里继续执行，但是返回这之前run_timer_list函数中就应该调用了del_timer，为什么返回后还会调用一次del_timer呢？\n还有我看指导书上说run_timer_list会遍历所有的定时器，在代码中只是判断了第一个呀？难道说是增序排列的吗</md>\n我举例的代码代码如下</p>\n<pre class=\"prettyprint\">\nint do_sleep(unsigned int time) \n{\n\t\t\t......\n     schedule();\n\n    del_timer(timer);//这里又调用了一次\n    return 0;\n}\nvoid run_timer_list(void) \n{\n    bool intr_flag;\n    local_intr_save(intr_flag);\n    {\n        list_entry_t *le = list_next(&amp;timer_list);\n         if (le != &amp;timer_list) {\n            timer_t *timer = le2timer(le, timer_link);\n            assert(timer-&gt;expires != 0);\n            timer-&gt;expires --;\n            while (timer-&gt;expires == 0) {\n                le = list_next(le);\n                struct proc_struct *proc = timer-&gt;proc;\n                if (proc-&gt;wait_state != 0) {\n                    assert(proc-&gt;wait_state &amp; WT_INTERRUPTED);\n                }\n                else {\n                    warn(&#34;process %d&#39;s wait_state == 0.\\n&#34;, proc-&gt;pid);\n                }\n                wakeup_proc(proc);\n                del_timer(timer);//这里调用了一次\n                if (le == &amp;timer_list) {\n                    break;\n                }\n                timer = le2timer(le, timer_link);\n            }\n        }\n        sched_class_proc_tick(current);\n    }\n    local_intr_restore(intr_flag);\n}</pre>"}], "type": "question", "tags": ["lab7", "student", "unanswered"], "tag_good": [], "unique_views": 108, "children": [], "tag_good_arr": [], "no_answer": 1, "id": "kgatw7y7wug3a0", "config": {"seen": {"352": 8, "265": 5, "1447": 7, "894": 9, "554": 1, "545": 2, "835": 4, "1184": 3, "1183": 6, "340": 0}}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 1, "num_favorites": 0, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643170212593, "default_anonymity": "no"}, "error": null, "aid": "kyv14aghxf23gm"}