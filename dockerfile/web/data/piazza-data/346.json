{"result": {"folders": ["lab4"], "nr": 346, "data": {"embed_links": []}, "created": "2015-04-22T08:17:35Z", "bucket_order": 3, "no_answer_followup": 0, "change_log": [{"uid": "i71i9b92nrr7n4", "anon": "no", "when": "2015-04-22T08:17:35Z", "data": "i8sgwi3p35b3h8", "type": "create"}, {"uid": "i71i9b92nrr7n4", "anon": "no", "when": "2015-04-22T08:23:48Z", "data": "i8sh4htkzio6np", "type": "update"}, {"to": "i8sgwi3mvwo3h7", "uid": "hs2swpdtr91gu", "anon": "no", "when": "2015-04-23T04:51:30Z", "data": "i8tozbkopmi2nl", "type": "i_answer"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "i71i9b92nrr7n4", "subject": "关于lab4, local_intr_save/restore", "created": "2015-04-22T08:23:48Z", "content": "<p>lab4當中為中断标記設置的兩個宏　(如下)</p>\n<p></p>\n<p>sync.h</p>\n<p></p>\n<p>#define local_intr_save(x)      do { x = __intr_save(); } while (0)<br />#define local_intr_restore(x)   __intr_restore(x);</p>\n<p></p>\n<p>请问为什么local_intr_save需要以do {   } while (0)包著核心部分的x = __intr_save();? 有什么安全原因么</p>\n<p></p>\n<p>另外是result中,　proc.c裡proc_run中的這一段</p>\n<p></p>\n<p>    bool intr_flag;<br />    local_intr_save(intr_flag);<br />    {<br />        proc-&gt;pid = get_pid();<br />        hash_proc(proc);<br />        list_add(&amp;proc_list, &amp;(proc-&gt;list_link));<br />        nr_process &#43;&#43;;<br />    }<br />    local_intr_restore(intr_flag);</p>\n<p></p>\n<p>看不太出來設置中断标記的必要, 求讲解 &#64;&#64;</p>"}, {"anon": "no", "uid": "i71i9b92nrr7n4", "subject": "关于lab4, local_intr_save", "created": "2015-04-22T08:17:35Z", "content": "<p>lab4當中為中断标記設置的兩個宏　(如下)</p>\n<p></p>\n<p>sync.h</p>\n<p></p>\n<p>#define local_intr_save(x)      do { x = __intr_save(); } while (0)<br />#define local_intr_restore(x)   __intr_restore(x);</p>\n<p></p>\n<p>请问为什么local_intr_save需要以do {   } while (0)包著核心部分的x = __intr_save();? 有什么安全原因么 &#64;&#64;</p>"}], "type": "question", "tags": ["lab4", "student"], "tag_good": [], "unique_views": 106, "children": [{"folders": [], "data": {"embed_links": []}, "children": [], "created": "2015-04-23T04:51:30Z", "bucket_order": 3, "tag_endorse": [], "bucket_name": "Today", "id": "i8tozbibq8g2nk", "history": [{"anon": "no", "uid": "hs2swpdtr91gu", "subject": "", "created": "2015-04-23T04:51:30Z", "content": "<p>为了保证操作的原子性&#xff0c;不会被中断打断。可以参考以下的讨论 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=309\">https://piazza.com/class/i5j09fnsl7k5x0?cid=309</a> </p>"}], "type": "i_answer", "tag_endorse_arr": [], "config": {}, "is_tag_endorse": false}], "tag_good_arr": [], "no_answer": 0, "id": "i8sgwi3mvwo3h7", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 3, "num_favorites": 0, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643167659884, "default_anonymity": "no"}, "error": null, "aid": "kyuzlkrwdgu4hp"}