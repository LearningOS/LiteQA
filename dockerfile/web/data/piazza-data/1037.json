{"result": {"folders": ["2017", "课堂问答", "lecture13", "lab4"], "nr": 1037, "data": {"embed_links": []}, "created": "2017-04-10T08:12:43Z", "bucket_order": 3, "no_answer_followup": 2, "change_log": [{"anon": "no", "uid": "hdjonbiyfs62ie", "data": "j1bubpo2old1qi", "type": "create", "when": "2017-04-10T08:12:43Z"}, {"anon": "no", "uid": "ie7xy8gtpwk1t5", "to": "j1bubpny1o51qh", "type": "followup", "when": "2017-04-16T08:37:11Z"}, {"anon": "no", "uid": "i0boovu8sh63xb", "to": "j1bubpny1o51qh", "type": "followup", "when": "2018-04-17T01:26:36Z"}, {"anon": "no", "uid": "ie7xy2fekwm1np", "to": "j1bubpny1o51qh", "type": "followup", "when": "2018-04-17T01:27:40Z"}, {"anon": "no", "uid": "jshndz5tgxj4bq", "to": "j1bubpny1o51qh", "type": "followup", "when": "2019-04-14T15:59:35Z"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "hdjonbiyfs62ie", "subject": "2017春季-第十三讲课堂实践练习(2)", "created": "2017-04-10T08:12:43Z", "content": "<p>请两人一组完成“第十三讲 实验四 内核线程管理”中指定小题的回答在此贴中回复&#xff0c;每组同学选做一个数据结构分析和一个流程分析。</p>\n<p></p>\n<p>题目&#xff1a;<br /><a href=\"https://chyyuu.gitbooks.io/os_course_exercises/content/all/05-3-lab4-spoc-discussion.html\">https://chyyuu.gitbooks.io/os_course_exercises/content/all/05-3-lab4-spoc-discussion.html</a></p>\n<p><br />视频相关思考题 -&gt; 13.2 关键数据结构 -&gt; 第5小题</p>\n<p></p>\n<p>分析trapframe数据结构&#xff0c;说明每个字段的用途&#xff0c;是由硬件或软件保存的&#xff0c;在内核态中断响应时是否会保存。</p>"}], "type": "note", "tags": ["2017", "instructor-note", "lab4", "lecture13", "课堂问答"], "tag_good": [], "unique_views": 94, "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p></p><pre>struct trapframe {<br />//段寄存器、通用寄存器:软件保存\n    struct pushregs tf_regs;\n    uint16_t tf_gs;\n    uint16_t tf_padding0;\n    uint16_t tf_fs;\n    uint16_t tf_padding1;\n    uint16_t tf_es;\n    uint16_t tf_padding2;\n    uint16_t tf_ds;\n    uint16_t tf_padding3;\n    uint32_t tf_trapno;\n<br />// 硬件保存:\n    uint32_t tf_err;\n    uintptr_t tf_eip;\n    uint16_t tf_cs;\n    uint16_t tf_padding4;\n    uint32_t tf_eflags;\n<br />// 特权级切换时保存\n    uintptr_t tf_esp;\n    uint16_t tf_ss;\n    uint16_t tf_padding5;\n} __attribute__((packed));</pre>\n<p></p>", "created": "2017-04-16T08:37:11Z", "bucket_order": 158, "bucket_name": "Week 4/9 - 4/15", "type": "followup", "tag_good": [], "uid": "ie7xy8gtpwk1t5", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "j1kfuaupb0m4n4", "updated": "2017-04-16T08:37:11Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>温家尊 2013080074</p>", "created": "2018-04-17T01:26:36Z", "bucket_order": 105, "bucket_name": "Week 4/15 - 4/21", "type": "followup", "tag_good": [], "uid": "i0boovu8sh63xb", "children": [], "tag_good_arr": [], "no_answer": 1, "id": "jg2zmcin7js1a7", "updated": "2018-04-17T01:26:36Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>上面讲的很清楚了&#xff0c;补充几个相关资料</p>\n<p></p>\n<p>软件保存部分</p>\n<p></p>\n<div style=\"font-family:&#34;Consolas&#34;,&#34;Courier New&#34;,monospace;font-weight:normal;font-size:14px;background-color:#1e1e1e;color:#d4d4d4\">\n<div><span style=\"color:#d4d4d4\">.globl vector1</span></div>\n<div><span style=\"color:#dcdcaa\">vector1:</span></div>\n<div><span style=\"color:#d4d4d4\"> pushl $</span><span style=\"color:#b5cea8\">0</span></div>\n<div><span style=\"color:#d4d4d4\"> pushl $</span><span style=\"color:#b5cea8\">1 //中断号</span></div>\n<div><span style=\"color:#d4d4d4\"> </span><span style=\"color:#569cd6\">jmp</span><span style=\"color:#d4d4d4\"> __alltraps</span></div>\n<div></div>\n</div>\n<div style=\"font-family:&#34;Consolas&#34;,&#34;Courier New&#34;,monospace;font-weight:normal;font-size:14px;background-color:#1e1e1e;color:#d4d4d4\">\n<div><span style=\"color:#dcdcaa\">__alltraps:</span></div>\n<div><span style=\"color:#569cd6\"> # </span><span style=\"color:#c586c0\">push</span><span style=\"color:#569cd6\"> registers to build a trap frame</span></div>\n<div><span style=\"color:#d4d4d4\"> </span><span style=\"color:#608b4e\"> # therefore make the stack look like a struct trapframe</span></div>\n<div><span style=\"color:#d4d4d4\"> pushl %</span><span style=\"color:#569cd6\">ds</span></div>\n<div><span style=\"color:#d4d4d4\"> pushl %</span><span style=\"color:#569cd6\">es</span></div>\n<div><span style=\"color:#d4d4d4\"> pushl %</span><span style=\"color:#569cd6\">fs</span></div>\n<div><span style=\"color:#d4d4d4\"> pushl %</span><span style=\"color:#569cd6\">gs</span></div>\n<div><span style=\"color:#d4d4d4\"> pushal</span></div>\n</div>\n<p></p>\n<p>硬件保存部分&#xff08;第七讲&#xff09;</p>\n<p></p>\n<p>&#xff08;底下有两张图片不知道加载不加载的出来&#xff0c;总之是第七讲的ppt里有写&#xff09;</p>\n<p></p>\n<p>无特权级切换时的中断</p>\n<p><img src=\"/img/1037-d1483306ac791b48.png\" alt=\"\" /></p>\n<p></p>\n<p>有特权级切换时的中断</p>\n<p><img src=\"/img/1037-4fb120b083993448.png\" alt=\"\" /></p>\n<p></p>\n<p></p>", "created": "2018-04-17T01:27:40Z", "bucket_order": 105, "bucket_name": "Week 4/15 - 4/21", "type": "followup", "tag_good": [], "uid": "ie7xy2fekwm1np", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "jg2znpgf27b474", "updated": "2018-04-17T01:27:40Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>仅补充两点</p>\n<p>1. 1楼“特权级切换时”在ucore中即ring 3 -&gt; ring 0</p>\n<p>2. 用于内核线程创建时&#xff0c;用到TCB中trapframe的以下字段</p>\n<ul><li>tf_regs::reg_ebx设为fn</li><li>tf_regs::reg_edx设为fn的args</li><li>tf_eip设为kernel_thread_entry&#xff0c;它会调用fn(args)&#xff0c;然后以前者的返回值为参数调用do_exit</li><li>tf_cs设为内核代码段</li><li>tf_ds, tf_es, tf_ss设为内核数据段</li></ul>", "created": "2019-04-14T15:59:35Z", "bucket_order": 53, "bucket_name": "Week 4/14 - 4/20", "type": "followup", "tag_good": [], "uid": "jshndz5tgxj4bq", "children": [], "tag_good_arr": [], "no_answer": 1, "id": "juh47df9ai6wc", "updated": "2019-04-14T15:59:35Z", "config": {}}], "tag_good_arr": [], "id": "j1bubpny1o51qh", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 5, "num_favorites": 0, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643169013190, "default_anonymity": "no"}, "error": null, "aid": "kyv0ekzq4yr3b9"}