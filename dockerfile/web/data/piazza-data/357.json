{"result": {"history_size": 3, "folders": ["lab6", "lecture16", "课堂问答", "2016"], "nr": 357, "data": {"embed_links": []}, "created": "2015-04-27T06:44:55Z", "bucket_order": 3, "no_answer_followup": 1, "change_log": [{"uid": "hdjonbiyfs62ie", "anon": "no", "when": "2015-04-27T06:44:55Z", "data": "i8zislb4yd6hc", "type": "create"}, {"uid": "hdjonbiyfs62ie", "anon": "no", "when": "2015-04-27T06:45:41Z", "data": "i8zitknxu77yq", "type": "update"}, {"to": "i8zislb2s6h6hb", "uid": "i6s09f3xHOf", "anon": "no", "when": "2015-04-27T06:48:30Z", "type": "followup"}, {"to": "i8zislb2s6h6hb", "uid": "i6rgfjo5j1r6c", "anon": "no", "when": "2015-04-27T06:56:42Z", "type": "followup"}, {"to": "i8zislb2s6h6hb", "uid": "i6roqnlkmtw", "anon": "no", "when": "2015-04-27T11:53:06Z", "type": "followup"}, {"to": "i8zislb2s6h6hb", "uid": "hrhsj9t1wSn", "anon": "no", "when": "2015-04-28T07:22:33Z", "type": "followup"}, {"to": "i8zislb2s6h6hb", "uid": "hdjonbiyfs62ie", "anon": "no", "when": "2015-04-29T06:20:06Z", "type": "feedback"}, {"to": "i8zislb2s6h6hb", "uid": "i6zqr3gqgef46t", "anon": "no", "when": "2015-05-01T11:05:19Z", "type": "followup"}, {"to": "i8zislb2s6h6hb", "anon": "stud", "when": "2015-05-25T17:18:56Z", "type": "followup", "uid_a": "a_0"}, {"anon": "no", "uid": "hdjonbiyfs62ie", "data": "j1ra0hbmgwxi1", "type": "update", "when": "2017-04-21T03:28:25Z"}, {"anon": "no", "uid": "hdjonbiyfs62ie", "to": "i8zislb2s6h6hb", "type": "followup", "when": "2017-04-21T06:42:51Z"}, {"anon": "no", "uid": "ie7xy1orb4a1mz", "to": "i8zislb2s6h6hb", "type": "feedback", "when": "2017-04-21T16:30:24Z"}, {"anon": "no", "uid": "itiooztjq0i1fk", "to": "i8zislb2s6h6hb", "type": "feedback", "when": "2017-04-24T14:47:02Z"}, {"anon": "no", "uid": "jsiyf76cGzf9", "to": "i8zislb2s6h6hb", "type": "followup", "when": "2019-04-24T13:47:44Z"}, {"anon": "no", "uid": "jkt3arvx7eGz", "to": "i8zislb2s6h6hb", "type": "feedback", "when": "2019-08-27T19:57:28Z"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "hdjonbiyfs62ie", "subject": "无符号数的有符号比较会产生什么效果&#xff1f;", "created": "2017-04-21T03:28:25Z", "content": "<p>有兴趣的同学&#xff0c;请在此回复你的答案。这可能是一个期末考试题目。</p>"}, {"anon": "no", "uid": "hdjonbiyfs62ie", "subject": "无符号数的有符号比较会产生什么效果&#xff1f;", "created": "2015-04-27T06:45:41Z", "content": "<p>有兴趣的同学&#xff0c;请在此回复你的答案。这可能是一个期末考试题目。</p>"}, {"anon": "no", "uid": "hdjonbiyfs62ie", "subject": "无符号数的有符号比较会产生什么效果&#xff1f;", "created": "2015-04-27T06:44:55Z", "content": "<p>有兴趣的同学&#xff0c;请在此回复你的答案。这可以是一个期末考试题目。</p>"}], "type": "note", "tags": ["2016", "instructor-note", "lab6", "lecture16", "课堂问答"], "tag_good": [{"role": "student", "name": "Yang Zhang", "endorser": {}, "admin": false, "photo": null, "id": "k2kjyuqgc5b2m1", "photo_url": null, "published": true, "us": false, "facebook_id": null}], "unique_views": 400, "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>李心成 陈振寰</p>\n<p>无符号数a&#xff0c;b&#xff0c;刚开始令a=b&#xff0c;a加完后溢出&#xff0c;对其进行有符号比较&#xff0c;此时a是正数&#xff0c;b是负数&#xff0c;a&gt;b&#xff0c;比较成功。</p>\n<p>代码中是先做a-b再将其转换为有符号&#xff0c;因此别的情况没有问题。</p>", "created": "2015-04-27T06:48:30Z", "bucket_order": 344, "bucket_name": "Week 4/26 - 5/2", "type": "followup", "tag_good": [], "uid": "i6s09f3xHOf", "children": [], "tag_good_arr": [], "no_answer": 1, "id": "i8zix6r2f2d0", "updated": "2015-04-27T06:48:30Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p></p>", "created": "2015-04-27T06:56:42Z", "bucket_order": 344, "bucket_name": "Week 4/26 - 5/2", "type": "followup", "tag_good": [], "uid": "i6rgfjo5j1r6c", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "i8zj7qpzsun46u", "updated": "2015-04-27T06:56:42Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>无符号整数ab作为两个stride<br />假设开始的时候a=b&#xff0c;之后b先增加。如果b没有溢出的话&#xff0c;此时a-b&lt;0&#xff0c;之后应该轮到a增加&#xff0c;此时是成功的。</p>\n<p>如果b溢出了话<br />首先看到schedule/default_sched.c中有一句 #define BIG_STRIDE 0x7FFFFFFF<br />因为stride每次的增量都是 BIG_STRIDE / priority&#xff0c;所以stride每次最大的增量不会超过BIG_STRIDE <br />那么因为b溢出了&#xff0c;所以b在溢出之前&#xff0c;ab相等&#xff0c;且无符号大于0x7FFFFFFF<br />                               在b溢出之后&#xff0c;a仍然保持原来大于0x7FFFFFFF&#xff0c;b小于0x7FFFFFFF<br />                               且a-b无符号大于0x7FFFFFFF&#xff08;因为b的步进值小于0x7FFFFFFF&#xff09;&#xff0c;也就是有符号小于0&#xff0c;仍然是成功的</p>\n<p></p>\n<p></p>\n<p>所以问题的关键就在于#define BIG_STRIDE 0x7FFFFFFF<br />这个值必须是有符号整数的最大值&#xff0c;这个是保证stride不会出错的原因<br />举个例子&#xff0c;把BIG_STRIDE增大&#xff0c;BIG_STRIDE=0xE0000000<br />那么初始令a=b=0xE0000000&#xff0c;b先前进0xE0000000&#xff0c;b变为0xC0000000&#xff0c;此时就有a-b&gt;0&#xff0c;stride算法就错了</p>", "created": "2015-04-27T11:53:06Z", "bucket_order": 344, "bucket_name": "Week 4/26 - 5/2", "type": "followup", "tag_good": [], "uid": "i6roqnlkmtw", "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p>这是一个优秀的回答。相关内容可能在期末考试中出现。</p>", "created": "2015-04-29T06:20:06Z", "bucket_order": 344, "bucket_name": "Week 4/26 - 5/2", "type": "feedback", "tag_good": [], "uid": "hdjonbiyfs62ie", "children": [], "tag_good_arr": [], "id": "i92csdu3s7o6qk", "updated": "2015-04-29T06:20:06Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p>如果ab都是有符号整数&#xff0c;其它的条件没变&#xff0c;好像效果也是一样的&#xff0c;所以为什么ab要是无符号整数呢&#xff1f;</p>", "created": "2019-08-27T19:57:28Z", "bucket_order": 118, "bucket_name": "Week 8/25 - 8/31", "type": "feedback", "tag_good": [], "uid": "jkt3arvx7eGz", "children": [], "tag_good_arr": [], "id": "jzu95aiww8r3bk", "updated": "2019-08-27T19:57:28Z", "config": {}}], "tag_good_arr": [], "no_answer": 0, "id": "i8ztswx7mo273u", "updated": "2015-04-27T11:53:06Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p><a href=\"http://www.kuqin.com/linux/20130710/334644.html\">http://www.kuqin.com/linux/20130710/334644.html</a></p>\n<p></p>\n<p>2013年&#xff0c;Linux 内核曾爆出了一个严重的安全漏洞&#xff0c;非root用户可以通过该漏洞的 exploit 获取root权限。这并不罕见&#xff0c;值得一提的是这个补丁看起来如此平常以至于我们绝大多数人都不会以为这是安全问题。<br /><br />先看这个问题的补丁&#xff0c;就是下面这个&#xff1a;<br /><br />  static int perf_swevent_init(struct perf_event *event)<br /> {<br />-    int event_id = event-&gt;attr.config;<br />&#43;    u64 event_id = event-&gt;attr.config;<br /><br />     if (event-&gt;attr.type != PERF_TYPE_SOFTWARE)<br />         return -ENOENT;<br /><br />我们第一眼的感觉就是这大概只是修复了编译器报的一个小警告吧&#xff0c;怎么会引起如此严重的安全问题呢&#xff1f;</p>\n<p></p>\n<p>如果传递进来的 event-&gt;attr.config 值正好设置了符号位&#xff0c;那么 event_id 就会变成负值&#xff0c;而且能躲过上面的检查。</p>", "created": "2015-04-28T07:22:33Z", "bucket_order": 344, "bucket_name": "Week 4/26 - 5/2", "type": "followup", "tag_good": [], "uid": "hrhsj9t1wSn", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "i90zkuejpy33h7", "updated": "2015-04-28T07:22:33Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>开始有A=B,最大步进S</p>\n<p>1.B&#43;S不溢出则需A&lt;B&#43;S,即0&lt;S,即S&lt;2^31</p>\n<p>2.B&#43;S溢出代表B&#43;S&gt;=2^32</p>\n<p>溢出后B&#39;=B&#43;S-2^32</p>\n<p>此时为使A-B&#39;&lt;0,需要A&gt;=B&#39;&#43;2^31</p>\n<p>即A&gt;=B&#43;S-2^32&#43;2^31=B&#43;S-2^31</p>\n<p>又由A=B</p>\n<p>有0&gt;=S-2^31</p>\n<p>即S&lt;=2^31</p>\n<p>综合有S&lt;2^31</p>\n<p>即S&lt;=0x7FFFFFFF</p>", "created": "2015-05-01T11:05:19Z", "bucket_order": 344, "bucket_name": "Week 4/26 - 5/2", "type": "followup", "tag_good": [], "uid": "i6zqr3gqgef46t", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "i95huvptscg7gm", "updated": "2015-05-01T11:05:19Z", "config": {}}, {"anon": "stud", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "上面同学回答的都是一个加完后溢出&#xff0c;另外的一定是负数&#xff08;两者相距不超过最大步长&#xff09;&#xff0c;这时候两者相减是没有问题的&#xff0c;但是我想问&#xff0c;如果ab本身都是正数&#xff0c;a加完后变为负数了&#xff0c;按理这时候应该执行b&#xff0c;但按上述理论不就先执行a了吗&#xff0c;这个要怎么解释呢&#xff1f;", "created": "2015-05-25T17:18:56Z", "bucket_order": 340, "bucket_name": "Week 5/24 - 5/30", "type": "followup", "tag_good": [], "uid_a": "a_0", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "ia45rsqvfwx7b6", "updated": "2015-05-25T17:18:56Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>2017-04-21: 请有兴趣的同学在本贴后回复你自己对stride溢出问题的分析。</p>", "created": "2017-04-21T06:42:50Z", "bucket_order": 241, "bucket_name": "Week 4/16 - 4/22", "type": "followup", "tag_good": [], "uid": "hdjonbiyfs62ie", "children": [{"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "<p></p><p>【约定】</p>\n<ul><li>\n<p>根据课上向老师的思路&#xff0c;我们可以将4字节的int简化为1字节来讨论。</p>\n</li><li>\n<p>考虑有A、B两个进程&#xff0c;其stride值分别记作<code>unsigned a,b</code>。</p>\n</li><li>\n<p>增量步长pass记作s。</p>\n</li><li>\n<p>stride值溢出&#xff0c;指的是无符号数的溢出&#xff0c;即a &gt;= 256。</p>\n</li><li>\n<p>“无符号数的有符号比较”这一技巧&#xff0c;下面简称“技巧”。它指的是(signed)(a-b)。</p>\n</li></ul>\n<p></p>\n<p>【已知结论】</p>\n<ul><li>\n<p>结论1&#xff1a;“stride值不溢出且a,b相差不超过127时&#xff0c;技巧是合理的。”</p>\n</li><li>\n<p>结论2&#xff1a;“若进程A的stride值溢出&#xff0c;则应转而执行进程B。”</p>\n</li></ul>\n<ul><li>\n<p>结论3&#xff1a;“s&lt;=255。”</p>\n</li></ul>\n<p>说明如下——</p>\n<p>结论1&#xff1a;若a=1, b=2&#xff0c;则显然signed(a-b) = -1&lt;0合理&#xff1b;</p>\n<p>若a=1, b=200&#xff0c;则signed(a-b) = signed(-199) = 57&gt;0不合理&#xff1b;</p>\n<p>若a=127, b=255&#xff0c;则signed(a-b) = signed(-128) = -128&lt;0合理&#xff1b;</p>\n<p>若a=255, b=127&#xff0c;则signed(a-b) = signed(128) = -128&lt;0不合理。</p>\n<p>故a, b至多相差127。</p>\n<p>结论2&#xff1a;这是合理的做法。</p>\n<p>结论3&#xff1a;否则&#xff0c;若s=256&#xff0c;则有a&#43;s = a&#xff0c;进程A将永远进行下去&#xff0c;不合理。</p>\n<p></p>\n<p>【stride值溢出时的情况分析】</p>\n<p>根据结论2&#xff0c;我们的“技巧”应保证&#xff1a;</p>\n<p>对于至多相差127的任意a, b&#xff0c;若①signed(a-b) &lt;= 0&#xff08;说明当前A在运行&#xff09;&#xff0c;且②a &#43; s &gt;= 256&#xff08;A的stride溢出&#xff09;&#xff0c;则有signed(a &#43; s - b) &gt; 0&#xff08;则应转为B来运行&#xff09;。</p>\n<p>假设a&lt;=127&#xff0c;则由于结论3&#xff0c;溢出后的a &#43; s &lt; a&#xff0c;signed(a-b) &lt; 0&#xff0c;不满足要求。</p>\n<p>故128 &lt;= a &lt;= b &lt;= 255。</p>\n<p>假设128 &lt;= s &lt;= 255&#xff0c;由于我们需要对任意满足条件的a, b都成立&#xff0c;故不妨取a = 255&#xff0c;b = 255&#xff0c;则signed(a &#43; s - b) = signed(s) &lt; 0&#xff0c;不满足要求。</p>\n<p>故s &lt;= 127。</p>\n<p>因此&#xff0c;<strong>若进程A发生stride值溢出&#xff0c;则增加s之前的情形为&#xff0c;128 &lt;= a &lt;= b &lt;= 255。</strong></p>\n<p><strong>当步长s &lt;= 127时&#xff0c;可以使得在溢出后&#xff0c;“技巧”仍能保证算法的正确性。</strong></p>\n<p></p>\n<p>【最终结论&#xff1a;最大步长限制】</p>\n<p>结合结论1&#xff0c;我们得到了如下结论&#xff1a;</p>\n<p><strong>当&#xff08;任意进程的&#xff09;步长s &lt;= 127时&#xff0c;“技巧”可以保证算法的正确性。&#xff08;无论是否发生stride值溢出。&#xff09;</strong></p>\n<p>把127换作0x7FFFFFFF&#xff0c;则得到了uint32下的结论。</p>\n<p>这也映证了李天润学长帖子里提到的schedule/default_sched.c中的 #define BIG_STRIDE 0x7FFFFFFF&#xff0c;每次增量pass = BIG_STRIDE / priority。事实上&#xff0c;这里的BIG_STRIDE&#xff0c;就是要保证算法正确性、可以取到的最大步长的准确值。</p>\n<p></p>\n<p>【注】</p>\n<p>上述证明可能还有不太严谨的地方&#xff0c;仅提供给大家作为一个参考思路~</p>", "created": "2017-04-21T16:30:24Z", "bucket_order": 241, "bucket_name": "Week 4/16 - 4/22", "type": "feedback", "tag_good": [], "uid": "ie7xy1orb4a1mz", "children": [], "tag_good_arr": [], "id": "j1s1y4i7xu73ma", "updated": "2017-04-21T16:30:24Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "subject": "没有溢出&#xff1a;\n两个无符号数A&#xff0c;BStride设为相同后B先整加&#xff0c;没有溢出说明A-B&lt;0,然后A增加就没有问题。\n有溢出&#xff1a;\nB增加后溢出&#xff08;B&#43;Pass&gt;2^32&#xff09;那么A-B&gt;0x7FFFFFFF,页可以。\n总之当PASS &lt;= 127时就可以无符号数的有符号比较", "created": "2017-04-24T14:47:02Z", "bucket_order": 240, "bucket_name": "Week 4/23 - 4/29", "type": "feedback", "tag_good": [], "uid": "itiooztjq0i1fk", "children": [], "tag_good_arr": [], "id": "j1w8kr1c8qec2", "updated": "2017-04-24T14:47:02Z", "config": {}}], "tag_good_arr": [], "no_answer": 0, "id": "j1rgyifnh0i68b", "updated": "2017-04-21T06:42:50Z", "config": {}}, {"anon": "no", "folders": [], "data": {"embed_links": null}, "no_upvotes": 0, "subject": "<p>假设a和b都是1字节无符号数&#xff0c;则</p>\n<p>$$ a - b = \\begin{cases} a - b &amp; a \\ge b \\\\ a - b &#43; 256 &amp; a &lt; b \\end{cases} $$</p>\n<p>定义a和b的距离为 $$ dis(a - b) = min{|a - b|, ||a - b| - 256|} $$</p>\n<p>即 dis(253, 250) = 3, dis(254, 4) = 6</p>\n<p>可以证明&#xff1a;a, b之间的距离一定小于a&#xff0c;b的步长的较大值s。</p>\n<p>&#xff08;1&#xff09;a&#xff0c;b都未溢出时&#xff0c;由于stride算法特征&#xff0c;显然是满足的</p>\n<p>&#xff08;2&#xff09;当有一个溢出时&#xff0c;dis(a, b) 也满足&#xff0c;</p>", "created": "2019-04-24T13:47:44Z", "bucket_order": 136, "bucket_name": "Week 4/21 - 4/27", "type": "followup", "tag_good": [], "uid": "jsiyf76cGzf9", "children": [], "tag_good_arr": [], "no_answer": 0, "id": "juv9wccgiue64j", "updated": "2019-04-24T13:47:44Z", "config": {}}], "tag_good_arr": ["k2kjyuqgc5b2m1"], "id": "i8zislb2s6h6hb", "config": {}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 13, "num_favorites": 14, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643167673338, "default_anonymity": "no"}, "error": null, "aid": "kyuzlv5m7ex5mt"}