{"result": {"folders": ["lab2"], "nr": 1477, "data": {"embed_links": []}, "created": "2020-07-05T12:35:25Z", "bucket_order": 3, "no_answer_followup": 0, "change_log": [{"anon": "no", "uid": "kb10o073bbg2xo", "data": "kc926gd91ln445", "v": "all", "type": "create", "when": "2020-07-05T12:35:25Z"}, {"anon": "no", "uid": "kb10o073bbg2xo", "data": "kc926suxl1j4a8", "type": "update", "when": "2020-07-05T12:35:42Z"}, {"anon": "no", "uid": "kb10o073bbg2xo", "data": "kc927el0g9j4gl", "type": "update", "when": "2020-07-05T12:36:10Z"}, {"anon": "no", "uid": "kb10o073bbg2xo", "data": "kc929gv7vus53c", "type": "update", "when": "2020-07-05T12:37:46Z"}], "bucket_name": "Today", "history": [{"anon": "no", "uid": "kb10o073bbg2xo", "subject": "lab2关于get_pte中分配page&#xff0c;建立页目录-页表项 的一点疑问", "created": "2020-07-05T12:37:46Z", "content": "<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在lab2的练习2代码中要求我&#xff0c;如果此线性地址&#xff08;la&#xff09;没有对应的页面目录&#xff0c;就要创建一个页面。</span></span></p>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在表示的答案中&#xff0c;它是这样写的&#xff1a;</span></span></p>\n<pre>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">if&#xff08;&#xff01;&#xff08;* pdep&#xff06;PTE_P&#xff09;&#xff09;{ </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        struct Page * page; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        if&#xff08;&#xff01;create ||&#xff08;page = alloc_page&#xff08;&#xff09;&#xff09;== NULL&#xff09;{ </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">            return NULL; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        } </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        set_page_ref&#xff08;page&#xff0c;1&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        uintptr_t pa = page2pa&#xff08;page&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        memset&#xff08;KADDR&#xff08;pa&#xff09;&#xff0c;0&#xff0c;PGSIZE&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        * pdep = pa | </span><span style=\"vertical-align:inherit\">PTE_U | </span><span style=\"vertical-align:inherit\">PTE_W | </span><span style=\"vertical-align:inherit\">PTE_P; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">    }</span></span>\n\n</pre>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ uintptr_t pa = page2pa&#xff08;page&#xff09;;”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">之前都很好理解&#xff0c;就是分配一个</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">page</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">&#xff0c;获得这个</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">页面</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">的</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">物理地址</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">。</span></span><br /><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">因为页</span><span style=\"vertical-align:inherit\">表目录和页表存储的是物理地址&#xff0c;</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">pd</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">和</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">pt</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">的基地址定位也要通过虚拟地址&#xff0c;所以</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ memset&#xff08;KADDR&#xff08;pa&#xff09;&#xff0c;0&#xff0c;PGSIZE&#xff09;;”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">也好理解&#xff0c;就是清空4K的虚拟内存。</span></span><br /><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">问题是&#xff0c;现在我准备好了一个内存块&#xff0c;我为什么能直接把</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">PDE</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">赋值为&#xff0c;</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">page</span></span></strong><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">存储的物理地址加上标志位&#xff1f;</span></span></strong></p>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">我的页表不用赋值值&#xff1f;&#xff1f;将pde赋值赋予</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ pa | </span><span style=\"vertical-align:inherit\">PTE_U | </span><span style=\"vertical-align:inherit\">PTE_W | </span><span style=\"vertical-align:inherit\">PTE_P”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">&#xff0c;我可以找到对应的页表基址吗&#xff1f;</span></span></p>"}, {"anon": "no", "uid": "kb10o073bbg2xo", "subject": "lab2关于get_pte中分配page&#xff0c;建立页目录-页表项 的一点疑问", "created": "2020-07-05T12:36:10Z", "content": "<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在lab2的练习2代码中要求我&#xff0c;如果此线性地址&#xff08;la&#xff09;没有对应的页面目录&#xff0c;就要创建一个页面。</span></span></p>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在表示的答案中&#xff0c;它是这样写的&#xff1a;</span></span></p>\n<pre>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">if&#xff08;&#xff01;&#xff08;* pdep&#xff06;PTE_P&#xff09;&#xff09;{ </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        struct Page * page; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        if&#xff08;&#xff01;create ||&#xff08;page = alloc_page&#xff08;&#xff09;&#xff09;== NULL&#xff09;{ </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">            return NULL; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        } </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        set_page_ref&#xff08;page&#xff0c;1&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        uintptr_t pa = page2pa&#xff08;page&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        memset&#xff08;KADDR&#xff08;pa&#xff09;&#xff0c;0&#xff0c;PGSIZE&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        * pdep = pa | </span><span style=\"vertical-align:inherit\">PTE_U | </span><span style=\"vertical-align:inherit\">PTE_W | </span><span style=\"vertical-align:inherit\">PTE_P; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">    }</span></span>\n\n</pre>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ uintptr_t pa = page2pa&#xff08;page&#xff09;;”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">之前都很好理解&#xff0c;就是分配一个</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">页面</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">&#xff0c;获得这个</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">页面</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">的</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">物理地址</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">。</span></span><br /><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">因为</span><strong><span style=\"vertical-align:inherit\">页面</span></strong><span style=\"vertical-align:inherit\">表目录和页面表存储的是物理地址&#xff0c;</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">pd</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">和</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">pt</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">的基地址定位也要通过虚拟地址&#xff0c;所以</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ memset&#xff08;KADDR&#xff08;pa&#xff09;&#xff0c;0&#xff0c;PGSIZE&#xff09;;”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">也好理解&#xff0c;就是清空4K的虚拟内存。</span></span><br /><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">问题是&#xff0c;现在我准备好了一个内存块&#xff0c;我为什么能直接把</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">PDE</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">赋值为&#xff0c;</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">网页存储的物理地址加上标志位&#xff1f;</span></span></strong></p>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">我的页表不用赋值值&#xff1f;&#xff1f;将pde赋值赋予</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ pa | </span><span style=\"vertical-align:inherit\">PTE_U | </span><span style=\"vertical-align:inherit\">PTE_W | </span><span style=\"vertical-align:inherit\">PTE_P”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">&#xff0c;我可以找到对应的页面表基址吗&#xff1f;</span></span></p>"}, {"anon": "no", "uid": "kb10o073bbg2xo", "subject": "lab2关于get_pte中分配page&#xff0c;建立页目录-页表项 的一点疑问", "created": "2020-07-05T12:35:42Z", "content": "<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在lab2的练习2代码中要求我&#xff0c;如果此线性地址&#xff08;la&#xff09;没有对应的页面目录&#xff0c;就要创建一个页面。</span></span></p>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在表示的答案中&#xff0c;它是这样写的&#xff1a;</span></span></p>\n<pre>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">if&#xff08;&#xff01;&#xff08;* pdep&#xff06;PTE_P&#xff09;&#xff09;{ </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        struct Page * page; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        if&#xff08;&#xff01;create ||&#xff08;page = alloc_page&#xff08;&#xff09;&#xff09;== NULL&#xff09;{ </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">            返回NULL; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        } </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        set_page_ref&#xff08;page&#xff0c;1&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        uintptr_t pa = page2pa&#xff08;page&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        memset&#xff08;KADDR&#xff08;pa&#xff09;&#xff0c;0&#xff0c;PGSIZE&#xff09;; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">        * pdep = pa | </span><span style=\"vertical-align:inherit\">PTE_U | </span><span style=\"vertical-align:inherit\">PTE_W | </span><span style=\"vertical-align:inherit\">PTE_P; </span></span>\n<span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">    }</span></span>\n\n</pre>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">在</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ uintptr_t pa = page2pa&#xff08;page&#xff09;;”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">之前都很好理解&#xff0c;就是分配一个</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">页面</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">&#xff0c;获得这个</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">页面</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">的</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">物理地址</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">。</span></span><br /><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">因为</span><strong><span style=\"vertical-align:inherit\">页面</span></strong><span style=\"vertical-align:inherit\">表目录和页面表存储的是物理地址&#xff0c;</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">pd</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">和</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">pt</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">的基地址定位也要通过虚拟地址&#xff0c;所以</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ memset&#xff08;KADDR&#xff08;pa&#xff09;&#xff0c;0&#xff0c;PGSIZE&#xff09;;”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">也好理解&#xff0c;就是清空4K的虚拟内存。</span></span><br /><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">问题是&#xff0c;现在我准备好了一个内存块&#xff0c;我为什么能直接把</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">PDE</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">赋值为&#xff0c;</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">网页存储的物理地址加上标志位&#xff1f;</span></span></strong></p>\n<p><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">我的页表不用赋值值&#xff1f;&#xff1f;将pde赋值赋予</span></span><strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">“ pa | </span><span style=\"vertical-align:inherit\">PTE_U | </span><span style=\"vertical-align:inherit\">PTE_W | </span><span style=\"vertical-align:inherit\">PTE_P”</span></span></strong><span style=\"vertical-align:inherit\"><span style=\"vertical-align:inherit\">&#xff0c;我可以找到对应的页面表基址吗&#xff1f;</span></span></p>"}, {"anon": "no", "uid": "kb10o073bbg2xo", "subject": "lab2关于get_pte中分配page&#xff0c;建立页目录-页表项 的一点疑问", "created": "2020-07-05T12:35:25Z", "content": "<p>在lab2 的练习2代码中要求我&#xff0c;如果此线性地址&#xff08;la&#xff09;没有对应的页目录&#xff0c;就要创建一个page。</p>\n<p>在给出的答案中&#xff0c;它是这样写的&#xff1a;</p>\n<pre>\nif (!(*pdep &amp; PTE_P)) {\n        struct Page *page;\n        if (!create || (page = alloc_page()) == NULL) {\n            return NULL;\n        }\n        set_page_ref(page, 1);\n        uintptr_t pa = page2pa(page);\n        memset(KADDR(pa), 0, PGSIZE);\n        *pdep = pa | PTE_U | PTE_W | PTE_P;\n    }\n\n</pre>\n<p>在<strong>“uintptr_t pa = page2pa(page);”</strong>之前都很好理解&#xff0c;就是分配一个<strong>page</strong>&#xff0c;获得这个<strong>page</strong>的<strong>物理地址</strong>。<br />因为页表目录和页表存储的是物理地址&#xff0c;<strong>pd </strong>和 <strong>pt </strong>的基地址的寻址也要通过虚拟地址&#xff0c;所以<strong>“memset(KADDR(pa), 0, PGSIZE);”</strong>也好理解&#xff0c;就是清空4K的虚拟内存。<br />问题是&#xff0c;现在我准备好了一个内存块&#xff0c;我为什么能直接把<strong>pde</strong>赋值为&#xff0c;<strong>page存储的物理地址加上标志位&#xff1f;</strong></p>\n<p>我的页表不用赋值吗&#xff1f;将pde赋值为<strong>“pa | PTE_U | PTE_W | PTE_P”</strong>&#xff0c;我可以找到对应的页表基址吗?</p>"}], "type": "question", "tags": ["lab2", "student", "unanswered"], "tag_good": [], "unique_views": 103, "children": [], "tag_good_arr": [], "no_answer": 1, "id": "kc926gd6mn7444", "config": {"seen": {"1404": 7, "1238": 5, "134": 3, "1303": 4, "1333": 9, "746": 2, "60": 8, "1350": 6, "1419": 1, "262": 0}}, "status": "active", "drafts": null, "request_instructor": 0, "request_instructor_me": false, "bookmarked": 1, "num_favorites": 0, "my_favorite": false, "is_bookmarked": false, "is_tag_good": false, "q_edits": [], "i_edits": [], "s_edits": [], "t": 1643170139995, "default_anonymity": "no"}, "error": null, "aid": "kyv12qfv7084s3"}